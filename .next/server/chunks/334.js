exports.id=334,exports.ids=[334],exports.modules={3334:(e,t,r)=>{"use strict";var a,n=Object.defineProperty,i=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,c={};((e,t)=>{for(var r in t)n(e,r,{get:t[r],enumerable:!0})})(c,{createBrowserSupabaseClient:()=>createBrowserSupabaseClient,createClientComponentClient:()=>createClientComponentClient,createMiddlewareClient:()=>createMiddlewareClient,createMiddlewareSupabaseClient:()=>createMiddlewareSupabaseClient,createPagesBrowserClient:()=>d,createPagesServerClient:()=>createPagesServerClient,createRouteHandlerClient:()=>createRouteHandlerClient,createServerActionClient:()=>v,createServerComponentClient:()=>createServerComponentClient,createServerSupabaseClient:()=>createServerSupabaseClient}),e.exports=((e,t,r,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of s(t))o.call(e,r)||void 0===r||n(e,r,{get:()=>t[r],enumerable:!(a=i(t,r))||a.enumerable});return e})(n({},"__esModule",{value:!0}),c);var l=r(7721);function createClientComponentClient({supabaseUrl:e="https://dghxekarmbhonhxfuvcy.supabase.co",supabaseKey:t="sb_publishable_pvVmjS51LQBYkJx7YVX3GQ_eKj-DP8q",options:r,cookieOptions:n,isSingleton:i=!0}={}){if(!e||!t)throw Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");let createNewClient=()=>{var a;return(0,l.createSupabaseClient)(e,t,{...r,global:{...null==r?void 0:r.global,headers:{...null==(a=null==r?void 0:r.global)?void 0:a.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.8.7"}},auth:{storage:new l.BrowserCookieAuthStorageAdapter(n)}})};if(i){let e=a??createNewClient();return"undefined"==typeof window?e:(a||(a=e),a)}return createNewClient()}var d=createClientComponentClient,u=r(7721),h=r(577),p=class extends u.CookieAuthStorageAdapter{constructor(e,t){super(t),this.context=e}getCookie(e){var t,r,a;let n=(0,h.splitCookiesString)((null==(r=null==(t=this.context.res)?void 0:t.getHeader("set-cookie"))?void 0:r.toString())??"").map(t=>(0,u.parseCookies)(t)[e]).find(e=>!!e),i=n??(null==(a=this.context.req)?void 0:a.cookies[e]);return i}setCookie(e,t){this._setCookie(e,t)}deleteCookie(e){this._setCookie(e,"",{maxAge:0})}_setCookie(e,t,r){var a;let n=(0,h.splitCookiesString)((null==(a=this.context.res.getHeader("set-cookie"))?void 0:a.toString())??"").filter(t=>!(e in(0,u.parseCookies)(t))),i=(0,u.serializeCookie)(e,t,{...this.cookieOptions,...r,httpOnly:!1});this.context.res.setHeader("set-cookie",[...n,i])}};function createPagesServerClient(e,{supabaseUrl:t="https://dghxekarmbhonhxfuvcy.supabase.co",supabaseKey:r="sb_publishable_pvVmjS51LQBYkJx7YVX3GQ_eKj-DP8q",options:a,cookieOptions:n}={}){var i;if(!t||!r)throw Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");return(0,u.createSupabaseClient)(t,r,{...a,global:{...null==a?void 0:a.global,headers:{...null==(i=null==a?void 0:a.global)?void 0:i.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.8.7"}},auth:{storage:new p(e,n)}})}var f=r(7721),y=r(577),m=class extends f.CookieAuthStorageAdapter{constructor(e,t){super(t),this.context=e}getCookie(e){var t;let r=(0,y.splitCookiesString)((null==(t=this.context.res.headers.get("set-cookie"))?void 0:t.toString())??"").map(t=>(0,f.parseCookies)(t)[e]).find(e=>!!e);if(r)return r;let a=(0,f.parseCookies)(this.context.req.headers.get("cookie")??"");return a[e]}setCookie(e,t){this._setCookie(e,t)}deleteCookie(e){this._setCookie(e,"",{maxAge:0})}_setCookie(e,t,r){let a=(0,f.serializeCookie)(e,t,{...this.cookieOptions,...r,httpOnly:!1});this.context.res.headers&&this.context.res.headers.append("set-cookie",a)}};function createMiddlewareClient(e,{supabaseUrl:t="https://dghxekarmbhonhxfuvcy.supabase.co",supabaseKey:r="sb_publishable_pvVmjS51LQBYkJx7YVX3GQ_eKj-DP8q",options:a,cookieOptions:n}={}){var i;if(!t||!r)throw Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");return(0,f.createSupabaseClient)(t,r,{...a,global:{...null==a?void 0:a.global,headers:{...null==(i=null==a?void 0:a.global)?void 0:i.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.8.7"}},auth:{storage:new m(e,n)}})}var g=r(7721),w=class extends g.CookieAuthStorageAdapter{constructor(e,t){super(t),this.context=e}getCookie(e){var t;let r=this.context.cookies();return null==(t=r.get(e))?void 0:t.value}setCookie(e,t){}deleteCookie(e){}};function createServerComponentClient(e,{supabaseUrl:t="https://dghxekarmbhonhxfuvcy.supabase.co",supabaseKey:r="sb_publishable_pvVmjS51LQBYkJx7YVX3GQ_eKj-DP8q",options:a,cookieOptions:n}={}){var i;if(!t||!r)throw Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");return(0,g.createSupabaseClient)(t,r,{...a,global:{...null==a?void 0:a.global,headers:{...null==(i=null==a?void 0:a.global)?void 0:i.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.8.7"}},auth:{storage:new w(e,n)}})}var b=r(7721),S=class extends b.CookieAuthStorageAdapter{constructor(e,t){super(t),this.context=e}getCookie(e){var t;let r=this.context.cookies();return null==(t=r.get(e))?void 0:t.value}setCookie(e,t){let r=this.context.cookies();r.set(e,t,this.cookieOptions)}deleteCookie(e){let t=this.context.cookies();t.set(e,"",{...this.cookieOptions,maxAge:0})}};function createRouteHandlerClient(e,{supabaseUrl:t="https://dghxekarmbhonhxfuvcy.supabase.co",supabaseKey:r="sb_publishable_pvVmjS51LQBYkJx7YVX3GQ_eKj-DP8q",options:a,cookieOptions:n}={}){var i;if(!t||!r)throw Error("either NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY env variables or supabaseUrl and supabaseKey are required!");return(0,b.createSupabaseClient)(t,r,{...a,global:{...null==a?void 0:a.global,headers:{...null==(i=null==a?void 0:a.global)?void 0:i.headers,"X-Client-Info":"@supabase/auth-helpers-nextjs@0.8.7"}},auth:{storage:new S(e,n)}})}var v=createRouteHandlerClient;function createBrowserSupabaseClient({supabaseUrl:e="https://dghxekarmbhonhxfuvcy.supabase.co",supabaseKey:t="sb_publishable_pvVmjS51LQBYkJx7YVX3GQ_eKj-DP8q",options:r,cookieOptions:a}={}){return console.warn("Please utilize the `createPagesBrowserClient` function instead of the deprecated `createBrowserSupabaseClient` function. Learn more: https://supabase.com/docs/guides/auth/auth-helpers/nextjs-pages"),d({supabaseUrl:e,supabaseKey:t,options:r,cookieOptions:a})}function createServerSupabaseClient(e,{supabaseUrl:t="https://dghxekarmbhonhxfuvcy.supabase.co",supabaseKey:r="sb_publishable_pvVmjS51LQBYkJx7YVX3GQ_eKj-DP8q",options:a,cookieOptions:n}={}){return console.warn("Please utilize the `createPagesServerClient` function instead of the deprecated `createServerSupabaseClient` function. Learn more: https://supabase.com/docs/guides/auth/auth-helpers/nextjs-pages"),createPagesServerClient(e,{supabaseUrl:t,supabaseKey:r,options:a,cookieOptions:n})}function createMiddlewareSupabaseClient(e,{supabaseUrl:t="https://dghxekarmbhonhxfuvcy.supabase.co",supabaseKey:r="sb_publishable_pvVmjS51LQBYkJx7YVX3GQ_eKj-DP8q",options:a,cookieOptions:n}={}){return console.warn("Please utilize the `createMiddlewareClient` function instead of the deprecated `createMiddlewareSupabaseClient` function. Learn more: https://supabase.com/docs/guides/auth/auth-helpers/nextjs#middleware"),createMiddlewareClient(e,{supabaseUrl:t,supabaseKey:r,options:a,cookieOptions:n})}},7721:(e,t,r)=>{"use strict";var a,n,i=Object.create,s=Object.defineProperty,o=Object.getOwnPropertyDescriptor,c=Object.getOwnPropertyNames,l=Object.getPrototypeOf,d=Object.prototype.hasOwnProperty,__copyProps=(e,t,r,a)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let n of c(t))d.call(e,n)||n===r||s(e,n,{get:()=>t[n],enumerable:!(a=o(t,n))||a.enumerable});return e},__toESM=(e,t,r)=>(r=null!=e?i(l(e)):{},__copyProps(!t&&e&&e.__esModule?r:s(r,"default",{value:e,enumerable:!0}),e)),u=(a={"../../node_modules/.pnpm/cookie@0.5.0/node_modules/cookie/index.js"(e){e.parse=parse3,e.serialize=serialize3;var t=Object.prototype.toString,r=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function parse3(e,t){if("string"!=typeof e)throw TypeError("argument str must be a string");for(var r={},a=(t||{}).decode||decode,n=0;n<e.length;){var i=e.indexOf("=",n);if(-1===i)break;var s=e.indexOf(";",n);if(-1===s)s=e.length;else if(s<i){n=e.lastIndexOf(";",i-1)+1;continue}var o=e.slice(n,i).trim();if(void 0===r[o]){var c=e.slice(i+1,s).trim();34===c.charCodeAt(0)&&(c=c.slice(1,-1)),r[o]=tryDecode(c,a)}n=s+1}return r}function serialize3(e,t,a){var n=a||{},i=n.encode||encode;if("function"!=typeof i)throw TypeError("option encode is invalid");if(!r.test(e))throw TypeError("argument name is invalid");var s=i(t);if(s&&!r.test(s))throw TypeError("argument val is invalid");var o=e+"="+s;if(null!=n.maxAge){var c=n.maxAge-0;if(isNaN(c)||!isFinite(c))throw TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(c)}if(n.domain){if(!r.test(n.domain))throw TypeError("option domain is invalid");o+="; Domain="+n.domain}if(n.path){if(!r.test(n.path))throw TypeError("option path is invalid");o+="; Path="+n.path}if(n.expires){var l=n.expires;if(!isDate(l)||isNaN(l.valueOf()))throw TypeError("option expires is invalid");o+="; Expires="+l.toUTCString()}if(n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.priority)switch("string"==typeof n.priority?n.priority.toLowerCase():n.priority){case"low":o+="; Priority=Low";break;case"medium":o+="; Priority=Medium";break;case"high":o+="; Priority=High";break;default:throw TypeError("option priority is invalid")}if(n.sameSite)switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"none":o+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return o}function decode(e){return -1!==e.indexOf("%")?decodeURIComponent(e):e}function encode(e){return encodeURIComponent(e)}function isDate(e){return"[object Date]"===t.call(e)||e instanceof Date}function tryDecode(e,t){try{return t(e)}catch(t){return e}}}},function(){return n||(0,a[c(a)[0]])((n={exports:{}}).exports,n),n.exports}),h={};((e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:!0})})(h,{BrowserCookieAuthStorageAdapter:()=>b,CookieAuthStorageAdapter:()=>w,DEFAULT_COOKIE_OPTIONS:()=>m,createSupabaseClient:()=>createSupabaseClient,isBrowser:()=>isBrowser,parseCookies:()=>f.parse,parseSupabaseCookie:()=>parseSupabaseCookie,serializeCookie:()=>f.serialize,stringifySupabaseSession:()=>stringifySupabaseSession}),e.exports=__copyProps(s({},"__esModule",{value:!0}),h);var p=__toESM(u()),f=__toESM(u()),y=r(2093);function parseSupabaseCookie(e){if(!e)return null;try{let t=JSON.parse(e);if(!t)return null;if("Object"===t.constructor.name)return t;if("Array"!==t.constructor.name)throw Error(`Unexpected format: ${t.constructor.name}`);let[r,a,n]=t[0].split("."),i=y.base64url.decode(a),s=new TextDecoder,{exp:o,sub:c,...l}=JSON.parse(s.decode(i));return{expires_at:o,expires_in:o-Math.round(Date.now()/1e3),token_type:"bearer",access_token:t[0],refresh_token:t[1],provider_token:t[2],provider_refresh_token:t[3],user:{id:c,factors:t[4],...l}}}catch(e){return console.warn("Failed to parse cookie string:",e),null}}function stringifySupabaseSession(e){var t;return JSON.stringify([e.access_token,e.refresh_token,e.provider_token,e.provider_refresh_token,(null==(t=e.user)?void 0:t.factors)??null])}function isBrowser(){return"undefined"!=typeof window&&void 0!==window.document}var m={path:"/",sameSite:"lax",maxAge:31536e6};function createChunkRegExp(e){return RegExp(".{1,"+e+"}","g")}var g=createChunkRegExp(3180);function createChunks(e,t,r){let a=void 0!==r?createChunkRegExp(r):g,n=Math.ceil(t.length/(r??3180));if(1===n)return[{name:e,value:t}];let i=[],s=t.match(a);return null==s||s.forEach((t,r)=>{let a=`${e}.${r}`;i.push({name:a,value:t})}),i}function combineChunks(e,t=()=>null){let r=[];for(let a=0;;a++){let n=`${e}.${a}`,i=t(n);if(!i)break;r.push(i)}return r.length?r.join(""):null}var w=class{constructor(e){this.cookieOptions={...m,...e,maxAge:m.maxAge}}getItem(e){let t=this.getCookie(e);if(e.endsWith("-code-verifier")&&t)return t;if(t)return JSON.stringify(parseSupabaseCookie(t));let r=combineChunks(e,e=>this.getCookie(e));return null!==r?JSON.stringify(parseSupabaseCookie(r)):null}setItem(e,t){if(e.endsWith("-code-verifier")){this.setCookie(e,t);return}let r=JSON.parse(t),a=stringifySupabaseSession(r),n=createChunks(e,a);n.forEach(e=>{this.setCookie(e.name,e.value)})}removeItem(e){this._deleteSingleCookie(e),this._deleteChunkedCookies(e)}_deleteSingleCookie(e){this.getCookie(e)&&this.deleteCookie(e)}_deleteChunkedCookies(e,t=0){for(let r=t;;r++){let t=`${e}.${r}`,a=this.getCookie(t);if(void 0===a)break;this.deleteCookie(t)}}},b=class extends w{constructor(e){super(e)}getCookie(e){if(!isBrowser())return null;let t=(0,p.parse)(document.cookie);return t[e]}setCookie(e,t){if(!isBrowser())return null;document.cookie=(0,p.serialize)(e,t,{...this.cookieOptions,httpOnly:!1})}deleteCookie(e){if(!isBrowser())return null;document.cookie=(0,p.serialize)(e,"",{...this.cookieOptions,maxAge:0,httpOnly:!1})}},S=r(8509);function createSupabaseClient(e,t,r){var a;let n=isBrowser();return(0,S.createClient)(e,t,{...r,auth:{flowType:"pkce",autoRefreshToken:n,detectSessionInUrl:n,persistSession:!0,storage:r.auth.storage,...(null==(a=r.auth)?void 0:a.storageKey)?{storageKey:r.auth.storageKey}:{}}})}/*! Bundled license information:

cookie/index.js:
  (*!
   * cookie
   * Copyright(c) 2012-2014 Roman Shtylman
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   *)
*/},2093:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cryptoRuntime=t.base64url=t.generateSecret=t.generateKeyPair=t.errors=t.decodeJwt=t.decodeProtectedHeader=t.importJWK=t.importX509=t.importPKCS8=t.importSPKI=t.exportJWK=t.exportSPKI=t.exportPKCS8=t.UnsecuredJWT=t.createRemoteJWKSet=t.createLocalJWKSet=t.EmbeddedJWK=t.calculateJwkThumbprintUri=t.calculateJwkThumbprint=t.EncryptJWT=t.SignJWT=t.GeneralSign=t.FlattenedSign=t.CompactSign=t.FlattenedEncrypt=t.CompactEncrypt=t.jwtDecrypt=t.jwtVerify=t.generalVerify=t.flattenedVerify=t.compactVerify=t.GeneralEncrypt=t.generalDecrypt=t.flattenedDecrypt=t.compactDecrypt=void 0;var a=r(3895);Object.defineProperty(t,"compactDecrypt",{enumerable:!0,get:function(){return a.compactDecrypt}});var n=r(8436);Object.defineProperty(t,"flattenedDecrypt",{enumerable:!0,get:function(){return n.flattenedDecrypt}});var i=r(29);Object.defineProperty(t,"generalDecrypt",{enumerable:!0,get:function(){return i.generalDecrypt}});var s=r(3186);Object.defineProperty(t,"GeneralEncrypt",{enumerable:!0,get:function(){return s.GeneralEncrypt}});var o=r(7662);Object.defineProperty(t,"compactVerify",{enumerable:!0,get:function(){return o.compactVerify}});var c=r(2800);Object.defineProperty(t,"flattenedVerify",{enumerable:!0,get:function(){return c.flattenedVerify}});var l=r(2200);Object.defineProperty(t,"generalVerify",{enumerable:!0,get:function(){return l.generalVerify}});var d=r(3252);Object.defineProperty(t,"jwtVerify",{enumerable:!0,get:function(){return d.jwtVerify}});var u=r(1251);Object.defineProperty(t,"jwtDecrypt",{enumerable:!0,get:function(){return u.jwtDecrypt}});var h=r(9660);Object.defineProperty(t,"CompactEncrypt",{enumerable:!0,get:function(){return h.CompactEncrypt}});var p=r(9394);Object.defineProperty(t,"FlattenedEncrypt",{enumerable:!0,get:function(){return p.FlattenedEncrypt}});var f=r(6763);Object.defineProperty(t,"CompactSign",{enumerable:!0,get:function(){return f.CompactSign}});var y=r(3986);Object.defineProperty(t,"FlattenedSign",{enumerable:!0,get:function(){return y.FlattenedSign}});var m=r(3219);Object.defineProperty(t,"GeneralSign",{enumerable:!0,get:function(){return m.GeneralSign}});var g=r(7130);Object.defineProperty(t,"SignJWT",{enumerable:!0,get:function(){return g.SignJWT}});var w=r(6229);Object.defineProperty(t,"EncryptJWT",{enumerable:!0,get:function(){return w.EncryptJWT}});var b=r(5048);Object.defineProperty(t,"calculateJwkThumbprint",{enumerable:!0,get:function(){return b.calculateJwkThumbprint}}),Object.defineProperty(t,"calculateJwkThumbprintUri",{enumerable:!0,get:function(){return b.calculateJwkThumbprintUri}});var S=r(4459);Object.defineProperty(t,"EmbeddedJWK",{enumerable:!0,get:function(){return S.EmbeddedJWK}});var v=r(7082);Object.defineProperty(t,"createLocalJWKSet",{enumerable:!0,get:function(){return v.createLocalJWKSet}});var E=r(4946);Object.defineProperty(t,"createRemoteJWKSet",{enumerable:!0,get:function(){return E.createRemoteJWKSet}});var _=r(2754);Object.defineProperty(t,"UnsecuredJWT",{enumerable:!0,get:function(){return _.UnsecuredJWT}});var P=r(6991);Object.defineProperty(t,"exportPKCS8",{enumerable:!0,get:function(){return P.exportPKCS8}}),Object.defineProperty(t,"exportSPKI",{enumerable:!0,get:function(){return P.exportSPKI}}),Object.defineProperty(t,"exportJWK",{enumerable:!0,get:function(){return P.exportJWK}});var k=r(2095);Object.defineProperty(t,"importSPKI",{enumerable:!0,get:function(){return k.importSPKI}}),Object.defineProperty(t,"importPKCS8",{enumerable:!0,get:function(){return k.importPKCS8}}),Object.defineProperty(t,"importX509",{enumerable:!0,get:function(){return k.importX509}}),Object.defineProperty(t,"importJWK",{enumerable:!0,get:function(){return k.importJWK}});var O=r(7902);Object.defineProperty(t,"decodeProtectedHeader",{enumerable:!0,get:function(){return O.decodeProtectedHeader}});var J=r(8717);Object.defineProperty(t,"decodeJwt",{enumerable:!0,get:function(){return J.decodeJwt}}),t.errors=r(9859);var C=r(2660);Object.defineProperty(t,"generateKeyPair",{enumerable:!0,get:function(){return C.generateKeyPair}});var A=r(2806);Object.defineProperty(t,"generateSecret",{enumerable:!0,get:function(){return A.generateSecret}}),t.base64url=r(293);var T=r(3778);Object.defineProperty(t,"cryptoRuntime",{enumerable:!0,get:function(){return T.default}})},3895:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compactDecrypt=void 0;let a=r(8436),n=r(9859),i=r(3823);async function compactDecrypt(e,t,r){if(e instanceof Uint8Array&&(e=i.decoder.decode(e)),"string"!=typeof e)throw new n.JWEInvalid("Compact JWE must be a string or Uint8Array");let{0:s,1:o,2:c,3:l,4:d,length:u}=e.split(".");if(5!==u)throw new n.JWEInvalid("Invalid Compact JWE");let h=await (0,a.flattenedDecrypt)({ciphertext:l,iv:c||void 0,protected:s||void 0,tag:d||void 0,encrypted_key:o||void 0},t,r),p={plaintext:h.plaintext,protectedHeader:h.protectedHeader};return"function"==typeof t?{...p,key:h.key}:p}t.compactDecrypt=compactDecrypt},9660:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompactEncrypt=void 0;let a=r(9394);let CompactEncrypt=class CompactEncrypt{constructor(e){this._flattened=new a.FlattenedEncrypt(e)}setContentEncryptionKey(e){return this._flattened.setContentEncryptionKey(e),this}setInitializationVector(e){return this._flattened.setInitializationVector(e),this}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}setKeyManagementParameters(e){return this._flattened.setKeyManagementParameters(e),this}async encrypt(e,t){let r=await this._flattened.encrypt(e,t);return[r.protected,r.encrypted_key,r.iv,r.ciphertext,r.tag].join(".")}};t.CompactEncrypt=CompactEncrypt},8436:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flattenedDecrypt=void 0;let a=r(4068),n=r(1180),i=r(1779),s=r(9859),o=r(9982),c=r(3297),l=r(3613),d=r(3823),u=r(2796),h=r(7869),p=r(4267);async function flattenedDecrypt(e,t,r){var f;let y,m,g,w,b,S,v;if(!(0,c.default)(e))throw new s.JWEInvalid("Flattened JWE must be an object");if(void 0===e.protected&&void 0===e.header&&void 0===e.unprotected)throw new s.JWEInvalid("JOSE Header missing");if("string"!=typeof e.iv)throw new s.JWEInvalid("JWE Initialization Vector missing or incorrect type");if("string"!=typeof e.ciphertext)throw new s.JWEInvalid("JWE Ciphertext missing or incorrect type");if("string"!=typeof e.tag)throw new s.JWEInvalid("JWE Authentication Tag missing or incorrect type");if(void 0!==e.protected&&"string"!=typeof e.protected)throw new s.JWEInvalid("JWE Protected Header incorrect type");if(void 0!==e.encrypted_key&&"string"!=typeof e.encrypted_key)throw new s.JWEInvalid("JWE Encrypted Key incorrect type");if(void 0!==e.aad&&"string"!=typeof e.aad)throw new s.JWEInvalid("JWE AAD incorrect type");if(void 0!==e.header&&!(0,c.default)(e.header))throw new s.JWEInvalid("JWE Shared Unprotected Header incorrect type");if(void 0!==e.unprotected&&!(0,c.default)(e.unprotected))throw new s.JWEInvalid("JWE Per-Recipient Unprotected Header incorrect type");if(e.protected)try{let t=(0,a.decode)(e.protected);y=JSON.parse(d.decoder.decode(t))}catch{throw new s.JWEInvalid("JWE Protected Header is invalid")}if(!(0,o.default)(y,e.header,e.unprotected))throw new s.JWEInvalid("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let E={...y,...e.header,...e.unprotected};if((0,h.default)(s.JWEInvalid,new Map,null==r?void 0:r.crit,y,E),void 0!==E.zip){if(!y||!y.zip)throw new s.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==E.zip)throw new s.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:_,enc:P}=E;if("string"!=typeof _||!_)throw new s.JWEInvalid("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof P||!P)throw new s.JWEInvalid("missing JWE Encryption Algorithm (enc) in JWE Header");let k=r&&(0,p.default)("keyManagementAlgorithms",r.keyManagementAlgorithms),O=r&&(0,p.default)("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(k&&!k.has(_))throw new s.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(O&&!O.has(P))throw new s.JOSEAlgNotAllowed('"enc" (Encryption Algorithm) Header Parameter not allowed');if(void 0!==e.encrypted_key)try{m=(0,a.decode)(e.encrypted_key)}catch{throw new s.JWEInvalid("Failed to base64url decode the encrypted_key")}let J=!1;"function"==typeof t&&(t=await t(y,e),J=!0);try{g=await (0,l.default)(_,t,m,E,r)}catch(e){if(e instanceof TypeError||e instanceof s.JWEInvalid||e instanceof s.JOSENotSupported)throw e;g=(0,u.default)(P)}try{w=(0,a.decode)(e.iv)}catch{throw new s.JWEInvalid("Failed to base64url decode the iv")}try{b=(0,a.decode)(e.tag)}catch{throw new s.JWEInvalid("Failed to base64url decode the tag")}let C=d.encoder.encode(null!==(f=e.protected)&&void 0!==f?f:"");S=void 0!==e.aad?(0,d.concat)(C,d.encoder.encode("."),d.encoder.encode(e.aad)):C;try{v=(0,a.decode)(e.ciphertext)}catch{throw new s.JWEInvalid("Failed to base64url decode the ciphertext")}let A=await (0,n.default)(P,g,v,w,b,S);"DEF"===E.zip&&(A=await ((null==r?void 0:r.inflateRaw)||i.inflate)(A));let T={plaintext:A};if(void 0!==e.protected&&(T.protectedHeader=y),void 0!==e.aad)try{T.additionalAuthenticatedData=(0,a.decode)(e.aad)}catch{throw new s.JWEInvalid("Failed to base64url decode the aad")}return(void 0!==e.unprotected&&(T.sharedUnprotectedHeader=e.unprotected),void 0!==e.header&&(T.unprotectedHeader=e.header),J)?{...T,key:t}:T}t.flattenedDecrypt=flattenedDecrypt},9394:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlattenedEncrypt=t.unprotected=void 0;let a=r(4068),n=r(4811),i=r(1779),s=r(1811),o=r(6069),c=r(9859),l=r(9982),d=r(3823),u=r(7869);t.unprotected=Symbol();let FlattenedEncrypt=class FlattenedEncrypt{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=e}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}async encrypt(e,r){let h,p,f,y,m,g,w;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new c.JWEInvalid("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!(0,l.default)(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new c.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let b={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if((0,u.default)(c.JWEInvalid,new Map,null==r?void 0:r.crit,this._protectedHeader,b),void 0!==b.zip){if(!this._protectedHeader||!this._protectedHeader.zip)throw new c.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==b.zip)throw new c.JOSENotSupported('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:S,enc:v}=b;if("string"!=typeof S||!S)throw new c.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof v||!v)throw new c.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if("dir"===S){if(this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if("ECDH-ES"===S&&this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");{let a;({cek:p,encryptedKey:h,parameters:a}=await (0,o.default)(S,v,e,this._cek,this._keyManagementParameters)),a&&(r&&t.unprotected in r?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...a}:this.setUnprotectedHeader(a):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...a}:this.setProtectedHeader(a))}if(this._iv||(this._iv=(0,s.default)(v)),y=this._protectedHeader?d.encoder.encode((0,a.encode)(JSON.stringify(this._protectedHeader))):d.encoder.encode(""),this._aad?(m=(0,a.encode)(this._aad),f=(0,d.concat)(y,d.encoder.encode("."),d.encoder.encode(m))):f=y,"DEF"===b.zip){let e=await ((null==r?void 0:r.deflateRaw)||i.deflate)(this._plaintext);({ciphertext:g,tag:w}=await (0,n.default)(v,e,p,this._iv,f))}else({ciphertext:g,tag:w}=await (0,n.default)(v,this._plaintext,p,this._iv,f));let E={ciphertext:(0,a.encode)(g),iv:(0,a.encode)(this._iv),tag:(0,a.encode)(w)};return h&&(E.encrypted_key=(0,a.encode)(h)),m&&(E.aad=m),this._protectedHeader&&(E.protected=d.decoder.decode(y)),this._sharedUnprotectedHeader&&(E.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(E.header=this._unprotectedHeader),E}};t.FlattenedEncrypt=FlattenedEncrypt},29:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generalDecrypt=void 0;let a=r(8436),n=r(9859),i=r(3297);async function generalDecrypt(e,t,r){if(!(0,i.default)(e))throw new n.JWEInvalid("General JWE must be an object");if(!Array.isArray(e.recipients)||!e.recipients.every(i.default))throw new n.JWEInvalid("JWE Recipients missing or incorrect type");if(!e.recipients.length)throw new n.JWEInvalid("JWE Recipients has no members");for(let n of e.recipients)try{return await (0,a.flattenedDecrypt)({aad:e.aad,ciphertext:e.ciphertext,encrypted_key:n.encrypted_key,header:n.header,iv:e.iv,protected:e.protected,tag:e.tag,unprotected:e.unprotected},t,r)}catch{}throw new n.JWEDecryptionFailed}t.generalDecrypt=generalDecrypt},3186:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeneralEncrypt=void 0;let a=r(9394),n=r(9859),i=r(2796),s=r(9982),o=r(6069),c=r(4068),l=r(7869);let IndividualRecipient=class IndividualRecipient{constructor(e,t,r){this.parent=e,this.key=t,this.options=r}setUnprotectedHeader(e){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addRecipient(...e){return this.parent.addRecipient(...e)}encrypt(...e){return this.parent.encrypt(...e)}done(){return this.parent}};let GeneralEncrypt=class GeneralEncrypt{constructor(e){this._recipients=[],this._plaintext=e}addRecipient(e,t){let r=new IndividualRecipient(this,e,{crit:null==t?void 0:t.crit});return this._recipients.push(r),r}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}async encrypt(e){var t,r,d;let u;if(!this._recipients.length)throw new n.JWEInvalid("at least one recipient must be added");if(e={deflateRaw:null==e?void 0:e.deflateRaw},1===this._recipients.length){let[t]=this._recipients,r=await new a.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(t.unprotectedHeader).encrypt(t.key,{...t.options,...e}),n={ciphertext:r.ciphertext,iv:r.iv,recipients:[{}],tag:r.tag};return r.aad&&(n.aad=r.aad),r.protected&&(n.protected=r.protected),r.unprotected&&(n.unprotected=r.unprotected),r.encrypted_key&&(n.recipients[0].encrypted_key=r.encrypted_key),r.header&&(n.recipients[0].header=r.header),n}for(let e=0;e<this._recipients.length;e++){let t=this._recipients[e];if(!(0,s.default)(this._protectedHeader,this._unprotectedHeader,t.unprotectedHeader))throw new n.JWEInvalid("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let r={...this._protectedHeader,...this._unprotectedHeader,...t.unprotectedHeader},{alg:a}=r;if("string"!=typeof a||!a)throw new n.JWEInvalid('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("dir"===a||"ECDH-ES"===a)throw new n.JWEInvalid('"dir" and "ECDH-ES" alg may only be used with a single recipient');if("string"!=typeof r.enc||!r.enc)throw new n.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(u){if(u!==r.enc)throw new n.JWEInvalid('JWE "enc" (Encryption Algorithm) Header Parameter must be the same for all recipients')}else u=r.enc;if((0,l.default)(n.JWEInvalid,new Map,t.options.crit,this._protectedHeader,r),void 0!==r.zip&&(!this._protectedHeader||!this._protectedHeader.zip))throw new n.JWEInvalid('JWE "zip" (Compression Algorithm) Header MUST be integrity protected')}let h=(0,i.default)(u),p={ciphertext:"",iv:"",recipients:[],tag:""};for(let n=0;n<this._recipients.length;n++){let i=this._recipients[n],s={};p.recipients.push(s);let l={...this._protectedHeader,...this._unprotectedHeader,...i.unprotectedHeader},f=l.alg.startsWith("PBES2")?2048+n:void 0;if(0===n){let t=await new a.FlattenedEncrypt(this._plaintext).setAdditionalAuthenticatedData(this._aad).setContentEncryptionKey(h).setProtectedHeader(this._protectedHeader).setSharedUnprotectedHeader(this._unprotectedHeader).setUnprotectedHeader(i.unprotectedHeader).setKeyManagementParameters({p2c:f}).encrypt(i.key,{...i.options,...e,[a.unprotected]:!0});p.ciphertext=t.ciphertext,p.iv=t.iv,p.tag=t.tag,t.aad&&(p.aad=t.aad),t.protected&&(p.protected=t.protected),t.unprotected&&(p.unprotected=t.unprotected),s.encrypted_key=t.encrypted_key,t.header&&(s.header=t.header);continue}let{encryptedKey:y,parameters:m}=await (0,o.default)((null===(t=i.unprotectedHeader)||void 0===t?void 0:t.alg)||(null===(r=this._protectedHeader)||void 0===r?void 0:r.alg)||(null===(d=this._unprotectedHeader)||void 0===d?void 0:d.alg),u,i.key,h,{p2c:f});s.encrypted_key=(0,c.encode)(y),(i.unprotectedHeader||m)&&(s.header={...i.unprotectedHeader,...m})}return p}};t.GeneralEncrypt=GeneralEncrypt},4459:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmbeddedJWK=void 0;let a=r(2095),n=r(3297),i=r(9859);async function EmbeddedJWK(e,t){let r={...e,...null==t?void 0:t.header};if(!(0,n.default)(r.jwk))throw new i.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a JSON object');let s=await (0,a.importJWK)({...r.jwk,ext:!0},r.alg,!0);if(s instanceof Uint8Array||"public"!==s.type)throw new i.JWSInvalid('"jwk" (JSON Web Key) Header Parameter must be a public key');return s}t.EmbeddedJWK=EmbeddedJWK},5048:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateJwkThumbprintUri=t.calculateJwkThumbprint=void 0;let a=r(3457),n=r(4068),i=r(9859),s=r(3823),o=r(3297),check=(e,t)=>{if("string"!=typeof e||!e)throw new i.JWKInvalid(`${t} missing or invalid`)};async function calculateJwkThumbprint(e,t){let r;if(!(0,o.default)(e))throw TypeError("JWK must be an object");if(null!=t||(t="sha256"),"sha256"!==t&&"sha384"!==t&&"sha512"!==t)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(e.kty){case"EC":check(e.crv,'"crv" (Curve) Parameter'),check(e.x,'"x" (X Coordinate) Parameter'),check(e.y,'"y" (Y Coordinate) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":check(e.crv,'"crv" (Subtype of Key Pair) Parameter'),check(e.x,'"x" (Public Key) Parameter'),r={crv:e.crv,kty:e.kty,x:e.x};break;case"RSA":check(e.e,'"e" (Exponent) Parameter'),check(e.n,'"n" (Modulus) Parameter'),r={e:e.e,kty:e.kty,n:e.n};break;case"oct":check(e.k,'"k" (Key Value) Parameter'),r={k:e.k,kty:e.kty};break;default:throw new i.JOSENotSupported('"kty" (Key Type) Parameter missing or unsupported')}let c=s.encoder.encode(JSON.stringify(r));return(0,n.encode)(await (0,a.default)(t,c))}async function calculateJwkThumbprintUri(e,t){null!=t||(t="sha256");let r=await calculateJwkThumbprint(e,t);return`urn:ietf:params:oauth:jwk-thumbprint:sha-${t.slice(-3)}:${r}`}t.calculateJwkThumbprint=calculateJwkThumbprint,t.calculateJwkThumbprintUri=calculateJwkThumbprintUri},7082:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createLocalJWKSet=t.LocalJWKSet=t.isJWKSLike=void 0;let a=r(2095),n=r(9859),i=r(3297);function getKtyFromAlg(e){switch("string"==typeof e&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new n.JOSENotSupported('Unsupported "alg" value for a JSON Web Key Set')}}function isJWKSLike(e){return e&&"object"==typeof e&&Array.isArray(e.keys)&&e.keys.every(isJWKLike)}function isJWKLike(e){return(0,i.default)(e)}function clone(e){return"function"==typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}t.isJWKSLike=isJWKSLike;let LocalJWKSet=class LocalJWKSet{constructor(e){if(this._cached=new WeakMap,!isJWKSLike(e))throw new n.JWKSInvalid("JSON Web Key Set malformed");this._jwks=clone(e)}async getKey(e,t){let{alg:r,kid:a}={...e,...null==t?void 0:t.header},i=getKtyFromAlg(r),s=this._jwks.keys.filter(e=>{let t=i===e.kty;if(t&&"string"==typeof a&&(t=a===e.kid),t&&"string"==typeof e.alg&&(t=r===e.alg),t&&"string"==typeof e.use&&(t="sig"===e.use),t&&Array.isArray(e.key_ops)&&(t=e.key_ops.includes("verify")),t&&"EdDSA"===r&&(t="Ed25519"===e.crv||"Ed448"===e.crv),t)switch(r){case"ES256":t="P-256"===e.crv;break;case"ES256K":t="secp256k1"===e.crv;break;case"ES384":t="P-384"===e.crv;break;case"ES512":t="P-521"===e.crv}return t}),{0:o,length:c}=s;if(0===c)throw new n.JWKSNoMatchingKey;if(1!==c){let e=new n.JWKSMultipleMatchingKeys,{_cached:t}=this;throw e[Symbol.asyncIterator]=async function*(){for(let e of s)try{yield await importWithAlgCache(t,e,r)}catch{continue}},e}return importWithAlgCache(this._cached,o,r)}};async function importWithAlgCache(e,t,r){let i=e.get(t)||e.set(t,{}).get(t);if(void 0===i[r]){let e=await (0,a.importJWK)({...t,ext:!0},r);if(e instanceof Uint8Array||"public"!==e.type)throw new n.JWKSInvalid("JSON Web Key Set members must be public keys");i[r]=e}return i[r]}function createLocalJWKSet(e){let t=new LocalJWKSet(e);return async function(e,r){return t.getKey(e,r)}}t.LocalJWKSet=LocalJWKSet,t.createLocalJWKSet=createLocalJWKSet},4946:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRemoteJWKSet=void 0;let a=r(3718),n=r(9859),i=r(7082);function isCloudflareWorkers(){return"undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime}let RemoteJWKSet=class RemoteJWKSet extends i.LocalJWKSet{constructor(e,t){if(super({keys:[]}),this._jwks=void 0,!(e instanceof URL))throw TypeError("url must be an instance of URL");this._url=new URL(e.href),this._options={agent:null==t?void 0:t.agent,headers:null==t?void 0:t.headers},this._timeoutDuration="number"==typeof(null==t?void 0:t.timeoutDuration)?null==t?void 0:t.timeoutDuration:5e3,this._cooldownDuration="number"==typeof(null==t?void 0:t.cooldownDuration)?null==t?void 0:t.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof(null==t?void 0:t.cacheMaxAge)?null==t?void 0:t.cacheMaxAge:6e5}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(e,t){this._jwks&&this.fresh()||await this.reload();try{return await super.getKey(e,t)}catch(r){if(r instanceof n.JWKSNoMatchingKey&&!1===this.coolingDown())return await this.reload(),super.getKey(e,t);throw r}}async reload(){this._pendingFetch&&isCloudflareWorkers()&&(this._pendingFetch=void 0),this._pendingFetch||(this._pendingFetch=(0,a.default)(this._url,this._timeoutDuration,this._options).then(e=>{if(!(0,i.isJWKSLike)(e))throw new n.JWKSInvalid("JSON Web Key Set malformed");this._jwks={keys:e.keys},this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(e=>{throw this._pendingFetch=void 0,e})),await this._pendingFetch}};function createRemoteJWKSet(e,t){let r=new RemoteJWKSet(e,t);return async function(e,t){return r.getKey(e,t)}}t.createRemoteJWKSet=createRemoteJWKSet},6763:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompactSign=void 0;let a=r(3986);let CompactSign=class CompactSign{constructor(e){this._flattened=new a.FlattenedSign(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,t){let r=await this._flattened.sign(e,t);if(void 0===r.payload)throw TypeError("use the flattened module for creating JWS with b64: false");return`${r.protected}.${r.payload}.${r.signature}`}};t.CompactSign=CompactSign},7662:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compactVerify=void 0;let a=r(2800),n=r(9859),i=r(3823);async function compactVerify(e,t,r){if(e instanceof Uint8Array&&(e=i.decoder.decode(e)),"string"!=typeof e)throw new n.JWSInvalid("Compact JWS must be a string or Uint8Array");let{0:s,1:o,2:c,length:l}=e.split(".");if(3!==l)throw new n.JWSInvalid("Invalid Compact JWS");let d=await (0,a.flattenedVerify)({payload:o,protected:s,signature:c},t,r),u={payload:d.payload,protectedHeader:d.protectedHeader};return"function"==typeof t?{...u,key:d.key}:u}t.compactVerify=compactVerify},3986:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlattenedSign=void 0;let a=r(4068),n=r(2554),i=r(9982),s=r(9859),o=r(3823),c=r(7952),l=r(7869);let FlattenedSign=class FlattenedSign{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,t){let r;if(!this._protectedHeader&&!this._unprotectedHeader)throw new s.JWSInvalid("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!(0,i.default)(this._protectedHeader,this._unprotectedHeader))throw new s.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let d={...this._protectedHeader,...this._unprotectedHeader},u=(0,l.default)(s.JWSInvalid,new Map([["b64",!0]]),null==t?void 0:t.crit,this._protectedHeader,d),h=!0;if(u.has("b64")&&"boolean"!=typeof(h=this._protectedHeader.b64))throw new s.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:p}=d;if("string"!=typeof p||!p)throw new s.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');(0,c.default)(p,e,"sign");let f=this._payload;h&&(f=o.encoder.encode((0,a.encode)(f))),r=this._protectedHeader?o.encoder.encode((0,a.encode)(JSON.stringify(this._protectedHeader))):o.encoder.encode("");let y=(0,o.concat)(r,o.encoder.encode("."),f),m=await (0,n.default)(p,e,y),g={signature:(0,a.encode)(m),payload:""};return h&&(g.payload=o.decoder.decode(f)),this._unprotectedHeader&&(g.header=this._unprotectedHeader),this._protectedHeader&&(g.protected=o.decoder.decode(r)),g}};t.FlattenedSign=FlattenedSign},2800:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flattenedVerify=void 0;let a=r(4068),n=r(1355),i=r(9859),s=r(3823),o=r(9982),c=r(3297),l=r(7952),d=r(7869),u=r(4267);async function flattenedVerify(e,t,r){var h;let p,f;if(!(0,c.default)(e))throw new i.JWSInvalid("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new i.JWSInvalid('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new i.JWSInvalid("JWS Protected Header incorrect type");if(void 0===e.payload)throw new i.JWSInvalid("JWS Payload missing");if("string"!=typeof e.signature)throw new i.JWSInvalid("JWS Signature missing or incorrect type");if(void 0!==e.header&&!(0,c.default)(e.header))throw new i.JWSInvalid("JWS Unprotected Header incorrect type");let y={};if(e.protected)try{let t=(0,a.decode)(e.protected);y=JSON.parse(s.decoder.decode(t))}catch{throw new i.JWSInvalid("JWS Protected Header is invalid")}if(!(0,o.default)(y,e.header))throw new i.JWSInvalid("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let m={...y,...e.header},g=(0,d.default)(i.JWSInvalid,new Map([["b64",!0]]),null==r?void 0:r.crit,y,m),w=!0;if(g.has("b64")&&"boolean"!=typeof(w=y.b64))throw new i.JWSInvalid('The "b64" (base64url-encode payload) Header Parameter must be a boolean');let{alg:b}=m;if("string"!=typeof b||!b)throw new i.JWSInvalid('JWS "alg" (Algorithm) Header Parameter missing or invalid');let S=r&&(0,u.default)("algorithms",r.algorithms);if(S&&!S.has(b))throw new i.JOSEAlgNotAllowed('"alg" (Algorithm) Header Parameter not allowed');if(w){if("string"!=typeof e.payload)throw new i.JWSInvalid("JWS Payload must be a string")}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new i.JWSInvalid("JWS Payload must be a string or an Uint8Array instance");let v=!1;"function"==typeof t&&(t=await t(y,e),v=!0),(0,l.default)(b,t,"verify");let E=(0,s.concat)(s.encoder.encode(null!==(h=e.protected)&&void 0!==h?h:""),s.encoder.encode("."),"string"==typeof e.payload?s.encoder.encode(e.payload):e.payload);try{p=(0,a.decode)(e.signature)}catch{throw new i.JWSInvalid("Failed to base64url decode the signature")}let _=await (0,n.default)(b,t,p,E);if(!_)throw new i.JWSSignatureVerificationFailed;if(w)try{f=(0,a.decode)(e.payload)}catch{throw new i.JWSInvalid("Failed to base64url decode the payload")}else f="string"==typeof e.payload?s.encoder.encode(e.payload):e.payload;let P={payload:f};return(void 0!==e.protected&&(P.protectedHeader=y),void 0!==e.header&&(P.unprotectedHeader=e.header),v)?{...P,key:t}:P}t.flattenedVerify=flattenedVerify},3219:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeneralSign=void 0;let a=r(3986),n=r(9859);let IndividualSignature=class IndividualSignature{constructor(e,t,r){this.parent=e,this.key=t,this.options=r}setProtectedHeader(e){if(this.protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this.protectedHeader=e,this}setUnprotectedHeader(e){if(this.unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this.unprotectedHeader=e,this}addSignature(...e){return this.parent.addSignature(...e)}sign(...e){return this.parent.sign(...e)}done(){return this.parent}};let GeneralSign=class GeneralSign{constructor(e){this._signatures=[],this._payload=e}addSignature(e,t){let r=new IndividualSignature(this,e,t);return this._signatures.push(r),r}async sign(){if(!this._signatures.length)throw new n.JWSInvalid("at least one signature must be added");let e={signatures:[],payload:""};for(let t=0;t<this._signatures.length;t++){let r=this._signatures[t],i=new a.FlattenedSign(this._payload);i.setProtectedHeader(r.protectedHeader),i.setUnprotectedHeader(r.unprotectedHeader);let{payload:s,...o}=await i.sign(r.key,r.options);if(0===t)e.payload=s;else if(e.payload!==s)throw new n.JWSInvalid("inconsistent use of JWS Unencoded Payload (RFC7797)");e.signatures.push(o)}return e}};t.GeneralSign=GeneralSign},2200:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generalVerify=void 0;let a=r(2800),n=r(9859),i=r(3297);async function generalVerify(e,t,r){if(!(0,i.default)(e))throw new n.JWSInvalid("General JWS must be an object");if(!Array.isArray(e.signatures)||!e.signatures.every(i.default))throw new n.JWSInvalid("JWS Signatures missing or incorrect type");for(let n of e.signatures)try{return await (0,a.flattenedVerify)({header:n.header,payload:e.payload,protected:n.protected,signature:n.signature},t,r)}catch{}throw new n.JWSSignatureVerificationFailed}t.generalVerify=generalVerify},1251:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jwtDecrypt=void 0;let a=r(3895),n=r(202),i=r(9859);async function jwtDecrypt(e,t,r){let s=await (0,a.compactDecrypt)(e,t,r),o=(0,n.default)(s.protectedHeader,s.plaintext,r),{protectedHeader:c}=s;if(void 0!==c.iss&&c.iss!==o.iss)throw new i.JWTClaimValidationFailed('replicated "iss" claim header parameter mismatch',"iss","mismatch");if(void 0!==c.sub&&c.sub!==o.sub)throw new i.JWTClaimValidationFailed('replicated "sub" claim header parameter mismatch',"sub","mismatch");if(void 0!==c.aud&&JSON.stringify(c.aud)!==JSON.stringify(o.aud))throw new i.JWTClaimValidationFailed('replicated "aud" claim header parameter mismatch',"aud","mismatch");let l={payload:o,protectedHeader:c};return"function"==typeof t?{...l,key:s.key}:l}t.jwtDecrypt=jwtDecrypt},6229:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptJWT=void 0;let a=r(9660),n=r(3823),i=r(7546);let EncryptJWT=class EncryptJWT extends i.ProduceJWT{setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}replicateIssuerAsHeader(){return this._replicateIssuerAsHeader=!0,this}replicateSubjectAsHeader(){return this._replicateSubjectAsHeader=!0,this}replicateAudienceAsHeader(){return this._replicateAudienceAsHeader=!0,this}async encrypt(e,t){let r=new a.CompactEncrypt(n.encoder.encode(JSON.stringify(this._payload)));return this._replicateIssuerAsHeader&&(this._protectedHeader={...this._protectedHeader,iss:this._payload.iss}),this._replicateSubjectAsHeader&&(this._protectedHeader={...this._protectedHeader,sub:this._payload.sub}),this._replicateAudienceAsHeader&&(this._protectedHeader={...this._protectedHeader,aud:this._payload.aud}),r.setProtectedHeader(this._protectedHeader),this._iv&&r.setInitializationVector(this._iv),this._cek&&r.setContentEncryptionKey(this._cek),this._keyManagementParameters&&r.setKeyManagementParameters(this._keyManagementParameters),r.encrypt(e,t)}};t.EncryptJWT=EncryptJWT},7546:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProduceJWT=void 0;let a=r(6828),n=r(3297),i=r(9180);let ProduceJWT=class ProduceJWT{constructor(e){if(!(0,n.default)(e))throw TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return"number"==typeof e?this._payload={...this._payload,nbf:e}:this._payload={...this._payload,nbf:(0,a.default)(new Date)+(0,i.default)(e)},this}setExpirationTime(e){return"number"==typeof e?this._payload={...this._payload,exp:e}:this._payload={...this._payload,exp:(0,a.default)(new Date)+(0,i.default)(e)},this}setIssuedAt(e){return void 0===e?this._payload={...this._payload,iat:(0,a.default)(new Date)}:this._payload={...this._payload,iat:e},this}};t.ProduceJWT=ProduceJWT},7130:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SignJWT=void 0;let a=r(6763),n=r(9859),i=r(3823),s=r(7546);let SignJWT=class SignJWT extends s.ProduceJWT{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,t){var r;let s=new a.CompactSign(i.encoder.encode(JSON.stringify(this._payload)));if(s.setProtectedHeader(this._protectedHeader),Array.isArray(null===(r=this._protectedHeader)||void 0===r?void 0:r.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new n.JWTInvalid("JWTs MUST NOT use unencoded payload");return s.sign(e,t)}};t.SignJWT=SignJWT},2754:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnsecuredJWT=void 0;let a=r(4068),n=r(3823),i=r(9859),s=r(202),o=r(7546);let UnsecuredJWT=class UnsecuredJWT extends o.ProduceJWT{encode(){let e=a.encode(JSON.stringify({alg:"none"})),t=a.encode(JSON.stringify(this._payload));return`${e}.${t}.`}static decode(e,t){let r;if("string"!=typeof e)throw new i.JWTInvalid("Unsecured JWT must be a string");let{0:o,1:c,2:l,length:d}=e.split(".");if(3!==d||""!==l)throw new i.JWTInvalid("Invalid Unsecured JWT");try{if(r=JSON.parse(n.decoder.decode(a.decode(o))),"none"!==r.alg)throw Error()}catch{throw new i.JWTInvalid("Invalid Unsecured JWT")}let u=(0,s.default)(r,a.decode(c),t);return{payload:u,header:r}}};t.UnsecuredJWT=UnsecuredJWT},3252:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jwtVerify=void 0;let a=r(7662),n=r(202),i=r(9859);async function jwtVerify(e,t,r){var s;let o=await (0,a.compactVerify)(e,t,r);if((null===(s=o.protectedHeader.crit)||void 0===s?void 0:s.includes("b64"))&&!1===o.protectedHeader.b64)throw new i.JWTInvalid("JWTs MUST NOT use unencoded payload");let c=(0,n.default)(o.protectedHeader,o.payload,r),l={payload:c,protectedHeader:o.protectedHeader};return"function"==typeof t?{...l,key:o.key}:l}t.jwtVerify=jwtVerify},6991:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exportJWK=t.exportPKCS8=t.exportSPKI=void 0;let a=r(694),n=r(694),i=r(6295);async function exportSPKI(e){return(0,a.toSPKI)(e)}async function exportPKCS8(e){return(0,n.toPKCS8)(e)}async function exportJWK(e){return(0,i.default)(e)}t.exportSPKI=exportSPKI,t.exportPKCS8=exportPKCS8,t.exportJWK=exportJWK},2660:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateKeyPair=void 0;let a=r(502);async function generateKeyPair(e,t){return(0,a.generateKeyPair)(e,t)}t.generateKeyPair=generateKeyPair},2806:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateSecret=void 0;let a=r(502);async function generateSecret(e,t){return(0,a.generateSecret)(e,t)}t.generateSecret=generateSecret},2095:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.importJWK=t.importPKCS8=t.importX509=t.importSPKI=void 0;let a=r(4068),n=r(694),i=r(3745),s=r(9859),o=r(3297);async function importSPKI(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PUBLIC KEY-----"))throw TypeError('"spki" must be SPKI formatted string');return(0,n.fromSPKI)(e,t,r)}async function importX509(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN CERTIFICATE-----"))throw TypeError('"x509" must be X.509 formatted string');return(0,n.fromX509)(e,t,r)}async function importPKCS8(e,t,r){if("string"!=typeof e||0!==e.indexOf("-----BEGIN PRIVATE KEY-----"))throw TypeError('"pkcs8" must be PKCS#8 formatted string');return(0,n.fromPKCS8)(e,t,r)}async function importJWK(e,t,r){var n;if(!(0,o.default)(e))throw TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');if(null!=r||(r=!0!==e.ext),r)return(0,i.default)({...e,alg:t,ext:null!==(n=e.ext)&&void 0!==n&&n});return(0,a.decode)(e.k);case"RSA":if(void 0!==e.oth)throw new s.JOSENotSupported('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return(0,i.default)({...e,alg:t});default:throw new s.JOSENotSupported('Unsupported "kty" (Key Type) Parameter value')}}t.importSPKI=importSPKI,t.importX509=importX509,t.importPKCS8=importPKCS8,t.importJWK=importJWK},934:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unwrap=t.wrap=void 0;let a=r(4811),n=r(1180),i=r(1811),s=r(4068);async function wrap(e,t,r,n){let o=e.slice(0,7);n||(n=(0,i.default)(o));let{ciphertext:c,tag:l}=await (0,a.default)(o,r,t,n,new Uint8Array(0));return{encryptedKey:c,iv:(0,s.encode)(n),tag:(0,s.encode)(l)}}async function unwrap(e,t,r,a,i){let s=e.slice(0,7);return(0,n.default)(s,t,r,a,i,new Uint8Array(0))}t.wrap=wrap,t.unwrap=unwrap},3823:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concatKdf=t.lengthAndInput=t.uint32be=t.uint64be=t.p2s=t.concat=t.decoder=t.encoder=void 0;let a=r(3457);function concat(...e){let t=e.reduce((e,{length:t})=>e+t,0),r=new Uint8Array(t),a=0;return e.forEach(e=>{r.set(e,a),a+=e.length}),r}function p2s(e,r){return concat(t.encoder.encode(e),new Uint8Array([0]),r)}function writeUInt32BE(e,t,r){if(t<0||t>=4294967296)throw RangeError(`value must be >= 0 and <= ${4294967296-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function uint64be(e){let t=new Uint8Array(8);return writeUInt32BE(t,Math.floor(e/4294967296),0),writeUInt32BE(t,e%4294967296,4),t}function uint32be(e){let t=new Uint8Array(4);return writeUInt32BE(t,e),t}function lengthAndInput(e){return concat(uint32be(e.length),e)}async function concatKdf(e,t,r){let n=Math.ceil((t>>3)/32),i=new Uint8Array(32*n);for(let t=0;t<n;t++){let n=new Uint8Array(4+e.length+r.length);n.set(uint32be(t+1)),n.set(e,4),n.set(r,4+e.length),i.set(await (0,a.default)("sha256",n),32*t)}return i.slice(0,t>>3)}t.encoder=new TextEncoder,t.decoder=new TextDecoder,t.concat=concat,t.p2s=p2s,t.uint64be=uint64be,t.uint32be=uint32be,t.lengthAndInput=lengthAndInput,t.concatKdf=concatKdf},2796:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bitLength=void 0;let a=r(9859),n=r(3671);function bitLength(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new a.JOSENotSupported(`Unsupported JWE Algorithm: ${e}`)}}t.bitLength=bitLength,t.default=e=>(0,n.default)(new Uint8Array(bitLength(e)>>3))},226:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(9859),n=r(1811);t.default=(e,t)=>{if(t.length<<3!==(0,n.bitLength)(e))throw new a.JWEInvalid("Invalid Initialization Vector length")}},7952:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(9314),n=r(8199),symmetricTypeCheck=(e,t)=>{if(!(t instanceof Uint8Array)){if(!(0,n.default)(t))throw TypeError((0,a.withAlg)(e,t,...n.types,"Uint8Array"));if("secret"!==t.type)throw TypeError(`${n.types.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}},asymmetricTypeCheck=(e,t,r)=>{if(!(0,n.default)(t))throw TypeError((0,a.withAlg)(e,t,...n.types));if("secret"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw TypeError(`${n.types.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)};t.default=(e,t,r)=>{let a=e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e);a?symmetricTypeCheck(e,t):asymmetricTypeCheck(e,t,r)}},2125:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(9859);function checkP2s(e){if(!(e instanceof Uint8Array)||e.length<8)throw new a.JWEInvalid("PBES2 Salt Input must be 8 or more octets")}t.default=checkP2s},100:(e,t)=>{"use strict";function unusable(e,t="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function isAlgorithm(e,t){return e.name===t}function getHashLength(e){return parseInt(e.name.slice(4),10)}function getNamedCurve(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}function checkUsage(e,t){if(t.length&&!t.some(t=>e.usages.includes(t))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw TypeError(e)}}function checkSigCryptoKey(e,t,...r){switch(t){case"HS256":case"HS384":case"HS512":{if(!isAlgorithm(e.algorithm,"HMAC"))throw unusable("HMAC");let r=parseInt(t.slice(2),10),a=getHashLength(e.algorithm.hash);if(a!==r)throw unusable(`SHA-${r}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!isAlgorithm(e.algorithm,"RSASSA-PKCS1-v1_5"))throw unusable("RSASSA-PKCS1-v1_5");let r=parseInt(t.slice(2),10),a=getHashLength(e.algorithm.hash);if(a!==r)throw unusable(`SHA-${r}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!isAlgorithm(e.algorithm,"RSA-PSS"))throw unusable("RSA-PSS");let r=parseInt(t.slice(2),10),a=getHashLength(e.algorithm.hash);if(a!==r)throw unusable(`SHA-${r}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==e.algorithm.name&&"Ed448"!==e.algorithm.name)throw unusable("Ed25519 or Ed448");break;case"ES256":case"ES384":case"ES512":{if(!isAlgorithm(e.algorithm,"ECDSA"))throw unusable("ECDSA");let r=getNamedCurve(t),a=e.algorithm.namedCurve;if(a!==r)throw unusable(r,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}checkUsage(e,r)}function checkEncCryptoKey(e,t,...r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!isAlgorithm(e.algorithm,"AES-GCM"))throw unusable("AES-GCM");let r=parseInt(t.slice(1,4),10),a=e.algorithm.length;if(a!==r)throw unusable(r,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!isAlgorithm(e.algorithm,"AES-KW"))throw unusable("AES-KW");let r=parseInt(t.slice(1,4),10),a=e.algorithm.length;if(a!==r)throw unusable(r,"algorithm.length");break}case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw unusable("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!isAlgorithm(e.algorithm,"PBKDF2"))throw unusable("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!isAlgorithm(e.algorithm,"RSA-OAEP"))throw unusable("RSA-OAEP");let r=parseInt(t.slice(9),10)||1,a=getHashLength(e.algorithm.hash);if(a!==r)throw unusable(`SHA-${r}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}checkUsage(e,r)}Object.defineProperty(t,"__esModule",{value:!0}),t.checkEncCryptoKey=t.checkSigCryptoKey=void 0,t.checkSigCryptoKey=checkSigCryptoKey,t.checkEncCryptoKey=checkEncCryptoKey},3613:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(4778),n=r(6942),i=r(8139),s=r(6244),o=r(4068),c=r(9859),l=r(2796),d=r(2095),u=r(7952),h=r(3297),p=r(934);async function decryptKeyManagement(e,t,r,f,y){switch((0,u.default)(e,t,"decrypt"),e){case"dir":if(void 0!==r)throw new c.JWEInvalid("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(void 0!==r)throw new c.JWEInvalid("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let i,s;if(!(0,h.default)(f.epk))throw new c.JWEInvalid('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!n.ecdhAllowed(t))throw new c.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let u=await (0,d.importJWK)(f.epk,e);if(void 0!==f.apu){if("string"!=typeof f.apu)throw new c.JWEInvalid('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{i=(0,o.decode)(f.apu)}catch{throw new c.JWEInvalid("Failed to base64url decode the apu")}}if(void 0!==f.apv){if("string"!=typeof f.apv)throw new c.JWEInvalid('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{s=(0,o.decode)(f.apv)}catch{throw new c.JWEInvalid("Failed to base64url decode the apv")}}let p=await n.deriveKey(u,t,"ECDH-ES"===e?f.enc:e,"ECDH-ES"===e?(0,l.bitLength)(f.enc):parseInt(e.slice(-5,-2),10),i,s);if("ECDH-ES"===e)return p;if(void 0===r)throw new c.JWEInvalid("JWE Encrypted Key missing");return(0,a.unwrap)(e.slice(-6),p,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===r)throw new c.JWEInvalid("JWE Encrypted Key missing");return(0,s.decrypt)(e,t,r);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let a;if(void 0===r)throw new c.JWEInvalid("JWE Encrypted Key missing");if("number"!=typeof f.p2c)throw new c.JWEInvalid('JOSE Header "p2c" (PBES2 Count) missing or invalid');let n=(null==y?void 0:y.maxPBES2Count)||1e4;if(f.p2c>n)throw new c.JWEInvalid('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof f.p2s)throw new c.JWEInvalid('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{a=(0,o.decode)(f.p2s)}catch{throw new c.JWEInvalid("Failed to base64url decode the p2s")}return(0,i.decrypt)(e,t,r,f.p2c,a)}case"A128KW":case"A192KW":case"A256KW":if(void 0===r)throw new c.JWEInvalid("JWE Encrypted Key missing");return(0,a.unwrap)(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let a,n;if(void 0===r)throw new c.JWEInvalid("JWE Encrypted Key missing");if("string"!=typeof f.iv)throw new c.JWEInvalid('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof f.tag)throw new c.JWEInvalid('JOSE Header "tag" (Authentication Tag) missing or invalid');try{a=(0,o.decode)(f.iv)}catch{throw new c.JWEInvalid("Failed to base64url decode the iv")}try{n=(0,o.decode)(f.tag)}catch{throw new c.JWEInvalid("Failed to base64url decode the tag")}return(0,p.unwrap)(e,t,r,a,n)}default:throw new c.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}}t.default=decryptKeyManagement},6069:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(4778),n=r(6942),i=r(8139),s=r(6244),o=r(4068),c=r(2796),l=r(9859),d=r(6991),u=r(7952),h=r(934);async function encryptKeyManagement(e,t,r,p,f={}){let y,m,g;switch((0,u.default)(e,r,"encrypt"),e){case"dir":g=r;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!n.ecdhAllowed(r))throw new l.JOSENotSupported("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:i,apv:s}=f,{epk:u}=f;u||(u=(await n.generateEpk(r)).privateKey);let{x:h,y:w,crv:b,kty:S}=await (0,d.exportJWK)(u),v=await n.deriveKey(r,u,"ECDH-ES"===e?t:e,"ECDH-ES"===e?(0,c.bitLength)(t):parseInt(e.slice(-5,-2),10),i,s);if(m={epk:{x:h,crv:b,kty:S}},"EC"===S&&(m.epk.y=w),i&&(m.apu=(0,o.encode)(i)),s&&(m.apv=(0,o.encode)(s)),"ECDH-ES"===e){g=v;break}g=p||(0,c.default)(t);let E=e.slice(-6);y=await (0,a.wrap)(E,v,g);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":g=p||(0,c.default)(t),y=await (0,s.encrypt)(e,r,g);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{g=p||(0,c.default)(t);let{p2c:a,p2s:n}=f;({encryptedKey:y,...m}=await (0,i.encrypt)(e,r,g,a,n));break}case"A128KW":case"A192KW":case"A256KW":g=p||(0,c.default)(t),y=await (0,a.wrap)(e,r,g);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{g=p||(0,c.default)(t);let{iv:a}=f;({encryptedKey:y,...m}=await (0,h.wrap)(e,r,g,a));break}default:throw new l.JOSENotSupported('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:g,encryptedKey:y,parameters:m}}t.default=encryptKeyManagement},6828:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=e=>Math.floor(e.getTime()/1e3)},9314:(e,t)=>{"use strict";function message(e,t,...r){if(r.length>2){let t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor&&t.constructor.name&&(e+=` Received an instance of ${t.constructor.name}`),e}function withAlg(e,t,...r){return message(`Key for the ${e} algorithm must be `,t,...r)}Object.defineProperty(t,"__esModule",{value:!0}),t.withAlg=void 0,t.default=(e,...t)=>message("Key must be ",e,...t),t.withAlg=withAlg},9982:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=(...e)=>{let t;let r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(!t||0===t.size){t=new Set(r);continue}for(let e of r){if(t.has(e))return!1;t.add(e)}}return!0}},3297:(e,t)=>{"use strict";function isObjectLike(e){return"object"==typeof e&&null!==e}function isObject(e){if(!isObjectLike(e)||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=isObject},1811:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bitLength=void 0;let a=r(9859),n=r(3671);function bitLength(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new a.JOSENotSupported(`Unsupported JWE Algorithm: ${e}`)}}t.bitLength=bitLength,t.default=e=>(0,n.default)(new Uint8Array(bitLength(e)>>3))},202:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(9859),n=r(3823),i=r(6828),s=r(9180),o=r(3297),normalizeTyp=e=>e.toLowerCase().replace(/^application\//,""),checkAudiencePresence=(e,t)=>"string"==typeof e?t.includes(e):!!Array.isArray(e)&&t.some(Set.prototype.has.bind(new Set(e)));t.default=(e,t,r={})=>{let c,l;let{typ:d}=r;if(d&&("string"!=typeof e.typ||normalizeTyp(e.typ)!==normalizeTyp(d)))throw new a.JWTClaimValidationFailed('unexpected "typ" JWT header value',"typ","check_failed");try{c=JSON.parse(n.decoder.decode(t))}catch{}if(!(0,o.default)(c))throw new a.JWTInvalid("JWT Claims Set must be a top-level JSON object");let{requiredClaims:u=[],issuer:h,subject:p,audience:f,maxTokenAge:y}=r;for(let e of(void 0!==y&&u.push("iat"),void 0!==f&&u.push("aud"),void 0!==p&&u.push("sub"),void 0!==h&&u.push("iss"),new Set(u.reverse())))if(!(e in c))throw new a.JWTClaimValidationFailed(`missing required "${e}" claim`,e,"missing");if(h&&!(Array.isArray(h)?h:[h]).includes(c.iss))throw new a.JWTClaimValidationFailed('unexpected "iss" claim value',"iss","check_failed");if(p&&c.sub!==p)throw new a.JWTClaimValidationFailed('unexpected "sub" claim value',"sub","check_failed");if(f&&!checkAudiencePresence(c.aud,"string"==typeof f?[f]:f))throw new a.JWTClaimValidationFailed('unexpected "aud" claim value',"aud","check_failed");switch(typeof r.clockTolerance){case"string":l=(0,s.default)(r.clockTolerance);break;case"number":l=r.clockTolerance;break;case"undefined":l=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:m}=r,g=(0,i.default)(m||new Date);if((void 0!==c.iat||y)&&"number"!=typeof c.iat)throw new a.JWTClaimValidationFailed('"iat" claim must be a number',"iat","invalid");if(void 0!==c.nbf){if("number"!=typeof c.nbf)throw new a.JWTClaimValidationFailed('"nbf" claim must be a number',"nbf","invalid");if(c.nbf>g+l)throw new a.JWTClaimValidationFailed('"nbf" claim timestamp check failed',"nbf","check_failed")}if(void 0!==c.exp){if("number"!=typeof c.exp)throw new a.JWTClaimValidationFailed('"exp" claim must be a number',"exp","invalid");if(c.exp<=g-l)throw new a.JWTExpired('"exp" claim timestamp check failed',"exp","check_failed")}if(y){let e=g-c.iat,t="number"==typeof y?y:(0,s.default)(y);if(e-l>t)throw new a.JWTExpired('"iat" claim timestamp check failed (too far in the past)',"iat","check_failed");if(e<0-l)throw new a.JWTClaimValidationFailed('"iat" claim timestamp check failed (it should be in the past)',"iat","check_failed")}return c}},9180:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let r=604800,a=31557600,n=/^(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i;t.default=e=>{let t=n.exec(e);if(!t)throw TypeError("Invalid time period format");let i=parseFloat(t[1]),s=t[2].toLowerCase();switch(s){case"sec":case"secs":case"second":case"seconds":case"s":return Math.round(i);case"minute":case"minutes":case"min":case"mins":case"m":return Math.round(60*i);case"hour":case"hours":case"hr":case"hrs":case"h":return Math.round(3600*i);case"day":case"days":case"d":return Math.round(86400*i);case"week":case"weeks":case"w":return Math.round(i*r);default:return Math.round(i*a)}}},4267:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)}},7869:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(9859);function validateCrit(e,t,r,n,i){let s;if(void 0!==i.crit&&void 0===n.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!n||void 0===n.crit)return new Set;if(!Array.isArray(n.crit)||0===n.crit.length||n.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let o of(s=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t,n.crit)){if(!s.has(o))throw new a.JOSENotSupported(`Extension Header Parameter "${o}" is not recognized`);if(void 0===i[o])throw new e(`Extension Header Parameter "${o}" is missing`);if(s.get(o)&&void 0===n[o])throw new e(`Extension Header Parameter "${o}" MUST be integrity protected`)}return new Set(n.crit)}t.default=validateCrit},4778:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unwrap=t.wrap=void 0;let a=r(4300),n=r(6113),i=r(9859),s=r(3823),o=r(6570),c=r(100),l=r(2805),d=r(9314),u=r(3447),h=r(8199);function checkKeySize(e,t){if(e.symmetricKeySize<<3!==parseInt(t.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${t}`)}function ensureKeyObject(e,t,r){if((0,l.default)(e))return e;if(e instanceof Uint8Array)return(0,n.createSecretKey)(e);if((0,o.isCryptoKey)(e))return(0,c.checkEncCryptoKey)(e,t,r),n.KeyObject.from(e);throw TypeError((0,d.default)(e,...h.types,"Uint8Array"))}t.wrap=(e,t,r)=>{let o=parseInt(e.slice(1,4),10),c=`aes${o}-wrap`;if(!(0,u.default)(c))throw new i.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`);let l=ensureKeyObject(t,e,"wrapKey");checkKeySize(l,e);let d=(0,n.createCipheriv)(c,l,a.Buffer.alloc(8,166));return(0,s.concat)(d.update(r),d.final())},t.unwrap=(e,t,r)=>{let o=parseInt(e.slice(1,4),10),c=`aes${o}-wrap`;if(!(0,u.default)(c))throw new i.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`);let l=ensureKeyObject(t,e,"unwrapKey");checkKeySize(l,e);let d=(0,n.createDecipheriv)(c,l,a.Buffer.alloc(8,166));return(0,s.concat)(d.update(r),d.final())}},694:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromX509=t.fromSPKI=t.fromPKCS8=t.toPKCS8=t.toSPKI=void 0;let a=r(6113),n=r(4300),i=r(6570),s=r(2805),o=r(9314),c=r(8199),genericExport=(e,t,r)=>{let n;if((0,i.isCryptoKey)(r)){if(!r.extractable)throw TypeError("CryptoKey is not extractable");n=a.KeyObject.from(r)}else if((0,s.default)(r))n=r;else throw TypeError((0,o.default)(r,...c.types));if(n.type!==e)throw TypeError(`key is not a ${e} key`);return n.export({format:"pem",type:t})};t.toSPKI=e=>genericExport("public","spki",e),t.toPKCS8=e=>genericExport("private","pkcs8",e),t.fromPKCS8=e=>(0,a.createPrivateKey)({key:n.Buffer.from(e.replace(/(?:-----(?:BEGIN|END) PRIVATE KEY-----|\s)/g,""),"base64"),type:"pkcs8",format:"der"}),t.fromSPKI=e=>(0,a.createPublicKey)({key:n.Buffer.from(e.replace(/(?:-----(?:BEGIN|END) PUBLIC KEY-----|\s)/g,""),"base64"),type:"spki",format:"der"}),t.fromX509=e=>(0,a.createPublicKey)({key:e,type:"spki",format:"pem"})},5286:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let Asn1SequenceDecoder=class Asn1SequenceDecoder{constructor(e){if(48!==e[0])throw TypeError();this.buffer=e,this.offset=1;let t=this.decodeLength();if(t!==e.length-this.offset)throw TypeError()}decodeLength(){let e=this.buffer[this.offset++];if(128&e){let t=-129&e;e=0;for(let r=0;r<t;r++)e=e<<8|this.buffer[this.offset+r];this.offset+=t}return e}unsignedInteger(){if(2!==this.buffer[this.offset++])throw TypeError();let e=this.decodeLength();0===this.buffer[this.offset]&&(this.offset++,e--);let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}end(){if(this.offset!==this.buffer.length)throw TypeError()}};t.default=Asn1SequenceDecoder},9249:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(4300),n=r(9859),i=a.Buffer.from([0]),s=a.Buffer.from([2]),o=a.Buffer.from([3]),c=a.Buffer.from([48]),l=a.Buffer.from([4]),encodeLength=e=>{if(e<128)return a.Buffer.from([e]);let t=a.Buffer.alloc(5);t.writeUInt32BE(e,1);let r=1;for(;0===t[r];)r++;return t[r-1]=128|5-r,t.slice(r-1)},d=new Map([["P-256",a.Buffer.from("06 08 2A 86 48 CE 3D 03 01 07".replace(/ /g,""),"hex")],["secp256k1",a.Buffer.from("06 05 2B 81 04 00 0A".replace(/ /g,""),"hex")],["P-384",a.Buffer.from("06 05 2B 81 04 00 22".replace(/ /g,""),"hex")],["P-521",a.Buffer.from("06 05 2B 81 04 00 23".replace(/ /g,""),"hex")],["ecPublicKey",a.Buffer.from("06 07 2A 86 48 CE 3D 02 01".replace(/ /g,""),"hex")],["X25519",a.Buffer.from("06 03 2B 65 6E".replace(/ /g,""),"hex")],["X448",a.Buffer.from("06 03 2B 65 6F".replace(/ /g,""),"hex")],["Ed25519",a.Buffer.from("06 03 2B 65 70".replace(/ /g,""),"hex")],["Ed448",a.Buffer.from("06 03 2B 65 71".replace(/ /g,""),"hex")]]);let DumbAsn1Encoder=class DumbAsn1Encoder{constructor(){this.length=0,this.elements=[]}oidFor(e){let t=d.get(e);if(!t)throw new n.JOSENotSupported("Invalid or unsupported OID");this.elements.push(t),this.length+=t.length}zero(){this.elements.push(s,a.Buffer.from([1]),i),this.length+=3}one(){this.elements.push(s,a.Buffer.from([1]),a.Buffer.from([1])),this.length+=3}unsignedInteger(e){if(128&e[0]){let t=encodeLength(e.length+1);this.elements.push(s,t,i,e),this.length+=2+t.length+e.length}else{let t=0;for(;0===e[t]&&(128&e[t+1])==0;)t++;let r=encodeLength(e.length-t);this.elements.push(s,encodeLength(e.length-t),e.slice(t)),this.length+=1+r.length+e.length-t}}octStr(e){let t=encodeLength(e.length);this.elements.push(l,encodeLength(e.length),e),this.length+=1+t.length+e.length}bitStr(e){let t=encodeLength(e.length+1);this.elements.push(o,encodeLength(e.length+1),i,e),this.length+=1+t.length+e.length+1}add(e){this.elements.push(e),this.length+=e.length}end(e=c){let t=encodeLength(this.length);return a.Buffer.concat([e,t,...this.elements],1+t.length+this.length)}};t.default=DumbAsn1Encoder},4068:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decode=t.encode=t.encodeBase64=t.decodeBase64=void 0;let a=r(4300),n=r(3823);function normalize(e){let t=e;return t instanceof Uint8Array&&(t=n.decoder.decode(t)),t}a.Buffer.isEncoding("base64url")?t.encode=e=>a.Buffer.from(e).toString("base64url"):t.encode=e=>a.Buffer.from(e).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),t.decodeBase64=e=>a.Buffer.from(e,"base64"),t.encodeBase64=e=>a.Buffer.from(e).toString("base64"),t.decode=e=>a.Buffer.from(normalize(e),"base64")},1371:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=r(3823);function cbcTag(e,t,r,i,s,o){let c=(0,n.concat)(e,t,r,(0,n.uint64be)(e.length<<3)),l=(0,a.createHmac)(`sha${i}`,s);return l.update(c),l.digest().slice(0,o>>3)}t.default=cbcTag},5490:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(9859),n=r(2805);t.default=(e,t)=>{let r;switch(e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":r=parseInt(e.slice(-3),10);break;case"A128GCM":case"A192GCM":case"A256GCM":r=parseInt(e.slice(1,4),10);break;default:throw new a.JOSENotSupported(`Content Encryption Algorithm ${e} is not supported either by JOSE or your javascript runtime`)}if(t instanceof Uint8Array){let e=t.byteLength<<3;if(e!==r)throw new a.JWEInvalid(`Invalid Content Encryption Key length. Expected ${r} bits, got ${e} bits`);return}if((0,n.default)(t)&&"secret"===t.type){let e=t.symmetricKeySize<<3;if(e!==r)throw new a.JWEInvalid(`Invalid Content Encryption Key length. Expected ${r} bits, got ${e} bits`);return}throw TypeError("Invalid Content Encryption Key type")}},659:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setModulusLength=t.weakMap=void 0,t.weakMap=new WeakMap;let getLength=(e,t)=>{let r=e.readUInt8(1);if((128&r)==0)return 0===t?r:getLength(e.subarray(2+r),t-1);let a=127&r;r=0;for(let t=0;t<a;t++){r<<=8;let a=e.readUInt8(2+t);r|=a}return 0===t?r:getLength(e.subarray(2+r),t-1)},getLengthOfSeqIndex=(e,t)=>{let r=e.readUInt8(1);return(128&r)==0?getLength(e.subarray(2),t):getLength(e.subarray(2+(127&r)),t)},getModulusLength=e=>{var r,a;if(t.weakMap.has(e))return t.weakMap.get(e);let n=null!==(a=null===(r=e.asymmetricKeyDetails)||void 0===r?void 0:r.modulusLength)&&void 0!==a?a:getLengthOfSeqIndex(e.export({format:"der",type:"pkcs1"}),"private"===e.type?1:0)-1<<3;return t.weakMap.set(e,n),n};t.setModulusLength=(e,r)=>{t.weakMap.set(e,r)},t.default=(e,t)=>{if(2048>getModulusLength(e))throw TypeError(`${t} requires key modulusLength to be 2048 bits or larger`)}},3447:(e,t,r)=>{"use strict";let a;Object.defineProperty(t,"__esModule",{value:!0});let n=r(6113);t.default=e=>(a||(a=new Set((0,n.getCiphers)())),a.has(e))},1180:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=r(226),i=r(5490),s=r(3823),o=r(9859),c=r(6563),l=r(1371),d=r(6570),u=r(100),h=r(2805),p=r(9314),f=r(3447),y=r(8199);function cbcDecrypt(e,t,r,n,i,d){let u,p;let y=parseInt(e.slice(1,4),10);(0,h.default)(t)&&(t=t.export());let m=t.subarray(y>>3),g=t.subarray(0,y>>3),w=parseInt(e.slice(-3),10),b=`aes-${y}-cbc`;if(!(0,f.default)(b))throw new o.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);let S=(0,l.default)(d,n,r,w,g,y);try{u=(0,c.default)(i,S)}catch{}if(!u)throw new o.JWEDecryptionFailed;try{let e=(0,a.createDecipheriv)(b,m,n);p=(0,s.concat)(e.update(r),e.final())}catch{}if(!p)throw new o.JWEDecryptionFailed;return p}function gcmDecrypt(e,t,r,n,i,s){let c=parseInt(e.slice(1,4),10),l=`aes-${c}-gcm`;if(!(0,f.default)(l))throw new o.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);try{let e=(0,a.createDecipheriv)(l,t,n,{authTagLength:16});e.setAuthTag(i),s.byteLength&&e.setAAD(s,{plaintextLength:r.length});let o=e.update(r);return e.final(),o}catch{throw new o.JWEDecryptionFailed}}t.default=(e,t,r,s,c,l)=>{let f;if((0,d.isCryptoKey)(t))(0,u.checkEncCryptoKey)(t,e,"decrypt"),f=a.KeyObject.from(t);else if(t instanceof Uint8Array||(0,h.default)(t))f=t;else throw TypeError((0,p.default)(t,...y.types,"Uint8Array"));switch((0,i.default)(e,f),(0,n.default)(e,s),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return cbcDecrypt(e,f,r,s,c,l);case"A128GCM":case"A192GCM":case"A256GCM":return gcmDecrypt(e,f,r,s,c,l);default:throw new o.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},3457:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113);t.default=(e,t)=>(0,a.createHash)(e).update(t).digest()},3888:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(9859);function dsaDigest(e){switch(e){case"PS256":case"RS256":case"ES256":case"ES256K":return"sha256";case"PS384":case"RS384":case"ES384":return"sha384";case"PS512":case"RS512":case"ES512":return"sha512";case"EdDSA":return;default:throw new a.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}t.default=dsaDigest},6942:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ecdhAllowed=t.generateEpk=t.deriveKey=void 0;let a=r(6113),n=r(3837),i=r(5507),s=r(3823),o=r(9859),c=r(6570),l=r(100),d=r(2805),u=r(9314),h=r(8199),p=(0,n.promisify)(a.generateKeyPair);async function deriveKey(e,t,r,n,i=new Uint8Array(0),o=new Uint8Array(0)){let p,f;if((0,c.isCryptoKey)(e))(0,l.checkEncCryptoKey)(e,"ECDH"),p=a.KeyObject.from(e);else if((0,d.default)(e))p=e;else throw TypeError((0,u.default)(e,...h.types));if((0,c.isCryptoKey)(t))(0,l.checkEncCryptoKey)(t,"ECDH","deriveBits"),f=a.KeyObject.from(t);else if((0,d.default)(t))f=t;else throw TypeError((0,u.default)(t,...h.types));let y=(0,s.concat)((0,s.lengthAndInput)(s.encoder.encode(r)),(0,s.lengthAndInput)(i),(0,s.lengthAndInput)(o),(0,s.uint32be)(n)),m=(0,a.diffieHellman)({privateKey:f,publicKey:p});return(0,s.concatKdf)(m,n,y)}async function generateEpk(e){let t;if((0,c.isCryptoKey)(e))t=a.KeyObject.from(e);else if((0,d.default)(e))t=e;else throw TypeError((0,u.default)(e,...h.types));switch(t.asymmetricKeyType){case"x25519":return p("x25519");case"x448":return p("x448");case"ec":{let e=(0,i.default)(t);return p("ec",{namedCurve:e})}default:throw new o.JOSENotSupported("Invalid or unsupported EPK")}}t.deriveKey=deriveKey,t.generateEpk=generateEpk,t.ecdhAllowed=e=>["P-256","P-384","P-521","X25519","X448"].includes((0,i.default)(e))},4811:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=r(226),i=r(5490),s=r(3823),o=r(1371),c=r(6570),l=r(100),d=r(2805),u=r(9314),h=r(9859),p=r(3447),f=r(8199);function cbcEncrypt(e,t,r,n,i){let c=parseInt(e.slice(1,4),10);(0,d.default)(r)&&(r=r.export());let l=r.subarray(c>>3),u=r.subarray(0,c>>3),f=`aes-${c}-cbc`;if(!(0,p.default)(f))throw new h.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);let y=(0,a.createCipheriv)(f,l,n),m=(0,s.concat)(y.update(t),y.final()),g=parseInt(e.slice(-3),10),w=(0,o.default)(i,n,m,g,u,c);return{ciphertext:m,tag:w}}function gcmEncrypt(e,t,r,n,i){let s=parseInt(e.slice(1,4),10),o=`aes-${s}-gcm`;if(!(0,p.default)(o))throw new h.JOSENotSupported(`alg ${e} is not supported by your javascript runtime`);let c=(0,a.createCipheriv)(o,r,n,{authTagLength:16});i.byteLength&&c.setAAD(i,{plaintextLength:t.length});let l=c.update(t);c.final();let d=c.getAuthTag();return{ciphertext:l,tag:d}}t.default=(e,t,r,s,o)=>{let p;if((0,c.isCryptoKey)(r))(0,l.checkEncCryptoKey)(r,e,"encrypt"),p=a.KeyObject.from(r);else if(r instanceof Uint8Array||(0,d.default)(r))p=r;else throw TypeError((0,u.default)(r,...f.types,"Uint8Array"));switch((0,i.default)(e,p),(0,n.default)(e,s),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return cbcEncrypt(e,t,p,s,o);case"A128GCM":case"A192GCM":case"A256GCM":return gcmEncrypt(e,t,p,s,o);default:throw new h.JOSENotSupported("Unsupported JWE Content Encryption Algorithm")}}},3718:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(3685),n=r(5687),i=r(2361),s=r(9859),o=r(3823),fetchJwks=async(e,t,r)=>{let c;switch(e.protocol){case"https:":c=n.get;break;case"http:":c=a.get;break;default:throw TypeError("Unsupported URL protocol.")}let{agent:l,headers:d}=r,u=c(e.href,{agent:l,timeout:t,headers:d}),[h]=await Promise.race([(0,i.once)(u,"response"),(0,i.once)(u,"timeout")]);if(!h)throw u.destroy(),new s.JWKSTimeout;if(200!==h.statusCode)throw new s.JOSEError("Expected 200 OK from the JSON Web Key Set HTTP response");let p=[];for await(let e of h)p.push(e);try{return JSON.parse(o.decoder.decode((0,o.concat)(...p)))}catch{throw new s.JOSEError("Failed to parse the JSON Web Key Set HTTP response as JSON")}};t.default=fetchJwks},1411:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jwkImport=t.jwkExport=t.rsaPssParams=t.oneShotCallback=void 0;let[r,a]=process.versions.node.split(".").map(e=>parseInt(e,10));t.oneShotCallback=r>=16||15===r&&a>=13,t.rsaPssParams=!("electron"in process.versions)&&(r>=17||16===r&&a>=9),t.jwkExport=r>=16||15===r&&a>=9,t.jwkImport=r>=16||15===r&&a>=12},502:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateKeyPair=t.generateSecret=void 0;let a=r(6113),n=r(3837),i=r(3671),s=r(659),o=r(9859),c=(0,n.promisify)(a.generateKeyPair);async function generateSecret(e,t){let r;switch(e){case"HS256":case"HS384":case"HS512":case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":r=parseInt(e.slice(-3),10);break;case"A128KW":case"A192KW":case"A256KW":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":case"A128GCM":case"A192GCM":case"A256GCM":r=parseInt(e.slice(1,4),10);break;default:throw new o.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return(0,a.createSecretKey)((0,i.default)(new Uint8Array(r>>3)))}async function generateKeyPair(e,t){var r,a;switch(e){case"RS256":case"RS384":case"RS512":case"PS256":case"PS384":case"PS512":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":case"RSA1_5":{let e=null!==(r=null==t?void 0:t.modulusLength)&&void 0!==r?r:2048;if("number"!=typeof e||e<2048)throw new o.JOSENotSupported("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");let a=await c("rsa",{modulusLength:e,publicExponent:65537});return(0,s.setModulusLength)(a.privateKey,e),(0,s.setModulusLength)(a.publicKey,e),a}case"ES256":return c("ec",{namedCurve:"P-256"});case"ES256K":return c("ec",{namedCurve:"secp256k1"});case"ES384":return c("ec",{namedCurve:"P-384"});case"ES512":return c("ec",{namedCurve:"P-521"});case"EdDSA":switch(null==t?void 0:t.crv){case void 0:case"Ed25519":return c("ed25519");case"Ed448":return c("ed448");default:throw new o.JOSENotSupported("Invalid or unsupported crv option provided, supported values are Ed25519 and Ed448")}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":let n=null!==(a=null==t?void 0:t.crv)&&void 0!==a?a:"P-256";switch(n){case void 0:case"P-256":case"P-384":case"P-521":return c("ec",{namedCurve:n});case"X25519":return c("x25519");case"X448":return c("x448");default:throw new o.JOSENotSupported("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}default:throw new o.JOSENotSupported('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}}t.generateSecret=generateSecret,t.generateKeyPair=generateKeyPair},5507:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setCurve=t.weakMap=void 0;let a=r(4300),n=r(6113),i=r(9859),s=r(6570),o=r(2805),c=r(9314),l=r(8199),d=a.Buffer.from([42,134,72,206,61,3,1,7]),u=a.Buffer.from([43,129,4,0,34]),h=a.Buffer.from([43,129,4,0,35]),p=a.Buffer.from([43,129,4,0,10]);t.weakMap=new WeakMap;let namedCurveToJOSE=e=>{switch(e){case"prime256v1":return"P-256";case"secp384r1":return"P-384";case"secp521r1":return"P-521";case"secp256k1":return"secp256k1";default:throw new i.JOSENotSupported("Unsupported key curve for this operation")}},getNamedCurve=(e,r)=>{var a;let f;if((0,s.isCryptoKey)(e))f=n.KeyObject.from(e);else if((0,o.default)(e))f=e;else throw TypeError((0,c.default)(e,...l.types));if("secret"===f.type)throw TypeError('only "private" or "public" type keys can be used for this operation');switch(f.asymmetricKeyType){case"ed25519":case"ed448":return`Ed${f.asymmetricKeyType.slice(2)}`;case"x25519":case"x448":return`X${f.asymmetricKeyType.slice(1)}`;case"ec":{if(t.weakMap.has(f))return t.weakMap.get(f);let e=null===(a=f.asymmetricKeyDetails)||void 0===a?void 0:a.namedCurve;if(e||"private"!==f.type){if(!e){let t=f.export({format:"der",type:"spki"}),r=t[1]<128?14:15,a=t[r],n=t.slice(r+1,r+1+a);if(n.equals(d))e="prime256v1";else if(n.equals(u))e="secp384r1";else if(n.equals(h))e="secp521r1";else if(n.equals(p))e="secp256k1";else throw new i.JOSENotSupported("Unsupported key curve for this operation")}}else e=getNamedCurve((0,n.createPublicKey)(f),!0);if(r)return e;let s=namedCurveToJOSE(e);return t.weakMap.set(f,s),s}default:throw TypeError("Invalid asymmetric key type for this operation")}};function setCurve(e,r){t.weakMap.set(e,r)}t.setCurve=setCurve,t.default=getNamedCurve},4878:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=r(6570),i=r(100),s=r(9314),o=r(8199);function getSignVerifyKey(e,t,r){if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw TypeError((0,s.default)(t,...o.types));return(0,a.createSecretKey)(t)}if(t instanceof a.KeyObject)return t;if((0,n.isCryptoKey)(t))return(0,i.checkSigCryptoKey)(t,e,r),a.KeyObject.from(t);throw TypeError((0,s.default)(t,...o.types,"Uint8Array"))}t.default=getSignVerifyKey},6768:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(9859);function hmacDigest(e){switch(e){case"HS256":return"sha256";case"HS384":return"sha384";case"HS512":return"sha512";default:throw new a.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}t.default=hmacDigest},8199:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.types=void 0;let a=r(6570),n=r(2805);t.default=e=>(0,n.default)(e)||(0,a.isCryptoKey)(e);let i=["KeyObject"];t.types=i,(globalThis.CryptoKey||(null===a.default||void 0===a.default?void 0:a.default.CryptoKey))&&i.push("CryptoKey")},2805:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=r(3837);t.default=n.types.isKeyObject?e=>n.types.isKeyObject(e):e=>null!=e&&e instanceof a.KeyObject},3745:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(4300),n=r(6113),i=r(4068),s=r(9859),o=r(5507),c=r(659),l=r(9249),d=r(1411);t.default=e=>{if(d.jwkImport&&"oct"!==e.kty)return e.d?(0,n.createPrivateKey)({format:"jwk",key:e}):(0,n.createPublicKey)({format:"jwk",key:e});switch(e.kty){case"oct":return(0,n.createSecretKey)((0,i.decode)(e.k));case"RSA":{let t=new l.default,r=void 0!==e.d,i=a.Buffer.from(e.n,"base64"),s=a.Buffer.from(e.e,"base64");r?(t.zero(),t.unsignedInteger(i),t.unsignedInteger(s),t.unsignedInteger(a.Buffer.from(e.d,"base64")),t.unsignedInteger(a.Buffer.from(e.p,"base64")),t.unsignedInteger(a.Buffer.from(e.q,"base64")),t.unsignedInteger(a.Buffer.from(e.dp,"base64")),t.unsignedInteger(a.Buffer.from(e.dq,"base64")),t.unsignedInteger(a.Buffer.from(e.qi,"base64"))):(t.unsignedInteger(i),t.unsignedInteger(s));let o=t.end(),d={key:o,format:"der",type:"pkcs1"},u=r?(0,n.createPrivateKey)(d):(0,n.createPublicKey)(d);return(0,c.setModulusLength)(u,i.length<<3),u}case"EC":{let t=new l.default,r=void 0!==e.d,i=a.Buffer.concat([a.Buffer.alloc(1,4),a.Buffer.from(e.x,"base64"),a.Buffer.from(e.y,"base64")]);if(r){t.zero();let r=new l.default;r.oidFor("ecPublicKey"),r.oidFor(e.crv),t.add(r.end());let s=new l.default;s.one(),s.octStr(a.Buffer.from(e.d,"base64"));let c=new l.default;c.bitStr(i);let d=c.end(a.Buffer.from([161]));s.add(d);let u=s.end(),h=new l.default;h.add(u);let p=h.end(a.Buffer.from([4]));t.add(p);let f=t.end(),y=(0,n.createPrivateKey)({key:f,format:"der",type:"pkcs8"});return(0,o.setCurve)(y,e.crv),y}let s=new l.default;s.oidFor("ecPublicKey"),s.oidFor(e.crv),t.add(s.end()),t.bitStr(i);let c=t.end(),d=(0,n.createPublicKey)({key:c,format:"der",type:"spki"});return(0,o.setCurve)(d,e.crv),d}case"OKP":{let t=new l.default,r=void 0!==e.d;if(r){t.zero();let r=new l.default;r.oidFor(e.crv),t.add(r.end());let i=new l.default;i.octStr(a.Buffer.from(e.d,"base64"));let s=i.end(a.Buffer.from([4]));t.add(s);let o=t.end();return(0,n.createPrivateKey)({key:o,format:"der",type:"pkcs8"})}let i=new l.default;i.oidFor(e.crv),t.add(i.end()),t.bitStr(a.Buffer.from(e.x,"base64"));let s=t.end();return(0,n.createPublicKey)({key:s,format:"der",type:"spki"})}default:throw new s.JOSENotSupported('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}}},6295:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=r(4068),i=r(5286),s=r(9859),o=r(5507),c=r(6570),l=r(2805),d=r(9314),u=r(8199),h=r(1411),keyToJWK=e=>{let t;if((0,c.isCryptoKey)(e)){if(!e.extractable)throw TypeError("CryptoKey is not extractable");t=a.KeyObject.from(e)}else if((0,l.default)(e))t=e;else if(e instanceof Uint8Array)return{kty:"oct",k:(0,n.encode)(e)};else throw TypeError((0,d.default)(e,...u.types,"Uint8Array"));if(h.jwkExport){if("secret"!==t.type&&!["rsa","ec","ed25519","x25519","ed448","x448"].includes(t.asymmetricKeyType))throw new s.JOSENotSupported("Unsupported key asymmetricKeyType");return t.export({format:"jwk"})}switch(t.type){case"secret":return{kty:"oct",k:(0,n.encode)(t.export())};case"private":case"public":switch(t.asymmetricKeyType){case"rsa":{let e;let r=t.export({format:"der",type:"pkcs1"}),a=new i.default(r);"private"===t.type&&a.unsignedInteger();let s=(0,n.encode)(a.unsignedInteger()),o=(0,n.encode)(a.unsignedInteger());return"private"===t.type&&(e={d:(0,n.encode)(a.unsignedInteger()),p:(0,n.encode)(a.unsignedInteger()),q:(0,n.encode)(a.unsignedInteger()),dp:(0,n.encode)(a.unsignedInteger()),dq:(0,n.encode)(a.unsignedInteger()),qi:(0,n.encode)(a.unsignedInteger())}),a.end(),{kty:"RSA",n:s,e:o,...e}}case"ec":{let e,r,i;let c=(0,o.default)(t);switch(c){case"secp256k1":e=64,r=33,i=-1;break;case"P-256":e=64,r=36,i=-1;break;case"P-384":e=96,r=35,i=-3;break;case"P-521":e=132,r=35,i=-3;break;default:throw new s.JOSENotSupported("Unsupported curve")}if("public"===t.type){let r=t.export({type:"spki",format:"der"});return{kty:"EC",crv:c,x:(0,n.encode)(r.subarray(-e,-e/2)),y:(0,n.encode)(r.subarray(-e/2))}}let l=t.export({type:"pkcs8",format:"der"});return l.length<100&&(r+=i),{...keyToJWK((0,a.createPublicKey)(t)),d:(0,n.encode)(l.subarray(r,r+e/2))}}case"ed25519":case"x25519":{let e=(0,o.default)(t);if("public"===t.type){let r=t.export({type:"spki",format:"der"});return{kty:"OKP",crv:e,x:(0,n.encode)(r.subarray(-32))}}let r=t.export({type:"pkcs8",format:"der"});return{...keyToJWK((0,a.createPublicKey)(t)),d:(0,n.encode)(r.subarray(-32))}}case"ed448":case"x448":{let e=(0,o.default)(t);if("public"===t.type){let r=t.export({type:"spki",format:"der"});return{kty:"OKP",crv:e,x:(0,n.encode)(r.subarray("Ed448"===e?-57:-56))}}let r=t.export({type:"pkcs8",format:"der"});return{...keyToJWK((0,a.createPublicKey)(t)),d:(0,n.encode)(r.subarray("Ed448"===e?-57:-56))}}default:throw new s.JOSENotSupported("Unsupported key asymmetricKeyType")}default:throw new s.JOSENotSupported("Unsupported key type")}};t.default=keyToJWK},5017:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=r(5507),i=r(9859),s=r(659),o=r(1411),c={padding:a.constants.RSA_PKCS1_PSS_PADDING,saltLength:a.constants.RSA_PSS_SALTLEN_DIGEST},l=new Map([["ES256","P-256"],["ES256K","secp256k1"],["ES384","P-384"],["ES512","P-521"]]);function keyForCrypto(e,t){switch(e){case"EdDSA":if(!["ed25519","ed448"].includes(t.asymmetricKeyType))throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ed25519 or ed448");return t;case"RS256":case"RS384":case"RS512":if("rsa"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,s.default)(t,e),t;case o.rsaPssParams&&"PS256":case o.rsaPssParams&&"PS384":case o.rsaPssParams&&"PS512":if("rsa-pss"===t.asymmetricKeyType){let{hashAlgorithm:r,mgf1HashAlgorithm:a,saltLength:n}=t.asymmetricKeyDetails,i=parseInt(e.slice(-3),10);if(void 0!==r&&(r!==`sha${i}`||a!==r))throw TypeError(`Invalid key for this operation, its RSA-PSS parameters do not meet the requirements of "alg" ${e}`);if(void 0!==n&&n>i>>3)throw TypeError(`Invalid key for this operation, its RSA-PSS parameter saltLength does not meet the requirements of "alg" ${e}`)}else if("rsa"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa or rsa-pss");return(0,s.default)(t,e),{key:t,...c};case!o.rsaPssParams&&"PS256":case!o.rsaPssParams&&"PS384":case!o.rsaPssParams&&"PS512":if("rsa"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");return(0,s.default)(t,e),{key:t,...c};case"ES256":case"ES256K":case"ES384":case"ES512":{if("ec"!==t.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be ec");let r=(0,n.default)(t),a=l.get(e);if(r!==a)throw TypeError(`Invalid key curve for the algorithm, its curve must be ${a}, got ${r}`);return{dsaEncoding:"ieee-p1363",key:t}}default:throw new i.JOSENotSupported(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}t.default=keyForCrypto},8139:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=void 0;let a=r(3837),n=r(6113),i=r(3671),s=r(3823),o=r(4068),c=r(4778),l=r(2125),d=r(6570),u=r(100),h=r(2805),p=r(9314),f=r(8199),y=(0,a.promisify)(n.pbkdf2);function getPassword(e,t){if((0,h.default)(e))return e.export();if(e instanceof Uint8Array)return e;if((0,d.isCryptoKey)(e))return(0,u.checkEncCryptoKey)(e,t,"deriveBits","deriveKey"),n.KeyObject.from(e).export();throw TypeError((0,p.default)(e,...f.types,"Uint8Array"))}let encrypt=async(e,t,r,a=2048,n=(0,i.default)(new Uint8Array(16)))=>{(0,l.default)(n);let d=(0,s.p2s)(e,n),u=parseInt(e.slice(13,16),10)>>3,h=getPassword(t,e),p=await y(h,d,a,u,`sha${e.slice(8,11)}`),f=await (0,c.wrap)(e.slice(-6),p,r);return{encryptedKey:f,p2c:a,p2s:(0,o.encode)(n)}};t.encrypt=encrypt;let decrypt=async(e,t,r,a,n)=>{(0,l.default)(n);let i=(0,s.p2s)(e,n),o=parseInt(e.slice(13,16),10)>>3,d=getPassword(t,e),u=await y(d,i,a,o,`sha${e.slice(8,11)}`);return(0,c.unwrap)(e.slice(-6),u,r)};t.decrypt=decrypt},3671:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(6113);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a.randomFillSync}})},6244:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decrypt=t.encrypt=void 0;let a=r(6113),n=r(659),i=r(6570),s=r(100),o=r(2805),c=r(9314),l=r(8199),checkKey=(e,t)=>{if("rsa"!==e.asymmetricKeyType)throw TypeError("Invalid key for this operation, its asymmetricKeyType must be rsa");(0,n.default)(e,t)},resolvePadding=e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return a.constants.RSA_PKCS1_OAEP_PADDING;case"RSA1_5":return a.constants.RSA_PKCS1_PADDING;default:return}},resolveOaepHash=e=>{switch(e){case"RSA-OAEP":return"sha1";case"RSA-OAEP-256":return"sha256";case"RSA-OAEP-384":return"sha384";case"RSA-OAEP-512":return"sha512";default:return}};function ensureKeyObject(e,t,...r){if((0,o.default)(e))return e;if((0,i.isCryptoKey)(e))return(0,s.checkEncCryptoKey)(e,t,...r),a.KeyObject.from(e);throw TypeError((0,c.default)(e,...l.types))}t.encrypt=(e,t,r)=>{let n=resolvePadding(e),i=resolveOaepHash(e),s=ensureKeyObject(t,e,"wrapKey","encrypt");return checkKey(s,e),(0,a.publicEncrypt)({key:s,oaepHash:i,padding:n},r)},t.decrypt=(e,t,r)=>{let n=resolvePadding(e),i=resolveOaepHash(e),s=ensureKeyObject(t,e,"unwrapKey","decrypt");return checkKey(s,e),(0,a.privateDecrypt)({key:s,oaepHash:i,padding:n},r)}},3455:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default="node:crypto"},2554:(e,t,r)=>{"use strict";let a;Object.defineProperty(t,"__esModule",{value:!0});let n=r(6113),i=r(3837),s=r(3888),o=r(6768),c=r(5017),l=r(4878);a=n.sign.length>3?(0,i.promisify)(n.sign):n.sign;let sign=async(e,t,r)=>{let i=(0,l.default)(e,t,"sign");if(e.startsWith("HS")){let t=n.createHmac((0,o.default)(e),i);return t.update(r),t.digest()}return a((0,s.default)(e),r,(0,c.default)(e,i))};t.default=sign},6563:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(6113),n=a.timingSafeEqual;t.default=n},1355:(e,t,r)=>{"use strict";let a;Object.defineProperty(t,"__esModule",{value:!0});let n=r(6113),i=r(3837),s=r(3888),o=r(5017),c=r(2554),l=r(4878),d=r(1411);a=n.verify.length>4&&d.oneShotCallback?(0,i.promisify)(n.verify):n.verify;let verify=async(e,t,r,i)=>{let d=(0,l.default)(e,t,"verify");if(e.startsWith("HS")){let t=await (0,c.default)(e,d,i);try{return n.timingSafeEqual(r,t)}catch{return!1}}let u=(0,s.default)(e),h=(0,o.default)(e,d);try{return await a(u,i,h,r)}catch{return!1}};t.default=verify},6570:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCryptoKey=void 0;let a=r(6113),n=r(3837),i=a.webcrypto;t.default=i,t.isCryptoKey=n.types.isCryptoKey?e=>n.types.isCryptoKey(e):e=>!1},1779:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deflate=t.inflate=void 0;let a=r(3837),n=r(9796),i=r(9859),s=(0,a.promisify)(n.inflateRaw),o=(0,a.promisify)(n.deflateRaw);t.inflate=e=>s(e,{maxOutputLength:25e4}).catch(()=>{throw new i.JWEDecompressionFailed}),t.deflate=e=>o(e)},293:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decode=t.encode=void 0;let a=r(4068);t.encode=a.encode,t.decode=a.decode},8717:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeJwt=void 0;let a=r(293),n=r(3823),i=r(3297),s=r(9859);function decodeJwt(e){let t,r;if("string"!=typeof e)throw new s.JWTInvalid("JWTs must use Compact JWS serialization, JWT must be a string");let{1:o,length:c}=e.split(".");if(5===c)throw new s.JWTInvalid("Only JWTs using Compact JWS serialization can be decoded");if(3!==c)throw new s.JWTInvalid("Invalid JWT");if(!o)throw new s.JWTInvalid("JWTs must contain a payload");try{t=(0,a.decode)(o)}catch{throw new s.JWTInvalid("Failed to base64url decode the payload")}try{r=JSON.parse(n.decoder.decode(t))}catch{throw new s.JWTInvalid("Failed to parse the decoded payload as JSON")}if(!(0,i.default)(r))throw new s.JWTInvalid("Invalid JWT Claims Set");return r}t.decodeJwt=decodeJwt},7902:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeProtectedHeader=void 0;let a=r(293),n=r(3823),i=r(3297);function decodeProtectedHeader(e){let t;if("string"==typeof e){let r=e.split(".");(3===r.length||5===r.length)&&([t]=r)}else if("object"==typeof e&&e){if("protected"in e)t=e.protected;else throw TypeError("Token does not contain a Protected Header")}try{if("string"!=typeof t||!t)throw Error();let e=JSON.parse(n.decoder.decode((0,a.decode)(t)));if(!(0,i.default)(e))throw Error();return e}catch{throw TypeError("Invalid Token or Protected Header formatting")}}t.decodeProtectedHeader=decodeProtectedHeader},9859:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JWSSignatureVerificationFailed=t.JWKSTimeout=t.JWKSMultipleMatchingKeys=t.JWKSNoMatchingKey=t.JWKSInvalid=t.JWKInvalid=t.JWTInvalid=t.JWSInvalid=t.JWEInvalid=t.JWEDecompressionFailed=t.JWEDecryptionFailed=t.JOSENotSupported=t.JOSEAlgNotAllowed=t.JWTExpired=t.JWTClaimValidationFailed=t.JOSEError=void 0;let JOSEError=class JOSEError extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(e){var t;super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,null===(t=Error.captureStackTrace)||void 0===t||t.call(Error,this,this.constructor)}};t.JOSEError=JOSEError;let JWTClaimValidationFailed=class JWTClaimValidationFailed extends JOSEError{static get code(){return"ERR_JWT_CLAIM_VALIDATION_FAILED"}constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=t,this.reason=r}};t.JWTClaimValidationFailed=JWTClaimValidationFailed;let JWTExpired=class JWTExpired extends JOSEError{static get code(){return"ERR_JWT_EXPIRED"}constructor(e,t="unspecified",r="unspecified"){super(e),this.code="ERR_JWT_EXPIRED",this.claim=t,this.reason=r}};t.JWTExpired=JWTExpired;let JOSEAlgNotAllowed=class JOSEAlgNotAllowed extends JOSEError{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}};t.JOSEAlgNotAllowed=JOSEAlgNotAllowed;let JOSENotSupported=class JOSENotSupported extends JOSEError{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}};t.JOSENotSupported=JOSENotSupported;let JWEDecryptionFailed=class JWEDecryptionFailed extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}};t.JWEDecryptionFailed=JWEDecryptionFailed;let JWEDecompressionFailed=class JWEDecompressionFailed extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWE_DECOMPRESSION_FAILED",this.message="decompression operation failed"}static get code(){return"ERR_JWE_DECOMPRESSION_FAILED"}};t.JWEDecompressionFailed=JWEDecompressionFailed;let JWEInvalid=class JWEInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}};t.JWEInvalid=JWEInvalid;let JWSInvalid=class JWSInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}static get code(){return"ERR_JWS_INVALID"}};t.JWSInvalid=JWSInvalid;let JWTInvalid=class JWTInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}static get code(){return"ERR_JWT_INVALID"}};t.JWTInvalid=JWTInvalid;let JWKInvalid=class JWKInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}static get code(){return"ERR_JWK_INVALID"}};t.JWKInvalid=JWKInvalid;let JWKSInvalid=class JWKSInvalid extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}static get code(){return"ERR_JWKS_INVALID"}};t.JWKSInvalid=JWKSInvalid;let JWKSNoMatchingKey=class JWKSNoMatchingKey extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWKS_NO_MATCHING_KEY",this.message="no applicable key found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_NO_MATCHING_KEY"}};t.JWKSNoMatchingKey=JWKSNoMatchingKey;let JWKSMultipleMatchingKeys=class JWKSMultipleMatchingKeys extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS",this.message="multiple matching keys found in the JSON Web Key Set"}static get code(){return"ERR_JWKS_MULTIPLE_MATCHING_KEYS"}};t.JWKSMultipleMatchingKeys=JWKSMultipleMatchingKeys,Symbol.asyncIterator;let JWKSTimeout=class JWKSTimeout extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWKS_TIMEOUT",this.message="request timed out"}static get code(){return"ERR_JWKS_TIMEOUT"}};t.JWKSTimeout=JWKSTimeout;let JWSSignatureVerificationFailed=class JWSSignatureVerificationFailed extends JOSEError{constructor(){super(...arguments),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED",this.message="signature verification failed"}static get code(){return"ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}};t.JWSSignatureVerificationFailed=JWSSignatureVerificationFailed},3778:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});let a=r(3455);t.default=a.default},577:e=>{"use strict";var t={decodeValues:!0,map:!1,silent:!1};function isForbiddenKey(e){return"string"!=typeof e||e in{}}function createNullObj(){return Object.create(null)}function isNonEmptyString(e){return"string"==typeof e&&!!e.trim()}function parseString(e,r){var a=e.split(";").filter(isNonEmptyString),n=parseNameValuePair(a.shift()),i=n.name,s=n.value;if(r=r?Object.assign({},t,r):t,isForbiddenKey(i))return null;try{s=r.decodeValues?decodeURIComponent(s):s}catch(e){console.error("set-cookie-parser: failed to decode cookie value. Set options.decodeValues=false to disable decoding.",e)}var o=createNullObj();return o.name=i,o.value=s,a.forEach(function(e){var t=e.split("="),r=t.shift().trimLeft().toLowerCase();if(!isForbiddenKey(r)){var a=t.join("=");if("expires"===r)o.expires=new Date(a);else if("max-age"===r){var n=parseInt(a,10);Number.isNaN(n)||(o.maxAge=n)}else"secure"===r?o.secure=!0:"httponly"===r?o.httpOnly=!0:"samesite"===r?o.sameSite=a:"partitioned"===r?o.partitioned=!0:r&&(o[r]=a)}}),o}function parseNameValuePair(e){var t="",r="",a=e.split("=");return a.length>1?(t=a.shift(),r=a.join("=")):r=e,{name:t,value:r}}function parse(e,r){if(r=r?Object.assign({},t,r):t,!e)return r.map?createNullObj():[];if(e.headers){if("function"==typeof e.headers.getSetCookie)e=e.headers.getSetCookie();else if(e.headers["set-cookie"])e=e.headers["set-cookie"];else{var a=e.headers[Object.keys(e.headers).find(function(e){return"set-cookie"===e.toLowerCase()})];a||!e.headers.cookie||r.silent||console.warn("Warning: set-cookie-parser appears to have been called on a request object. It is designed to parse Set-Cookie headers from responses, not Cookie headers from requests. Set the option {silent: true} to suppress this warning."),e=a}}if(Array.isArray(e)||(e=[e]),!r.map)return e.filter(isNonEmptyString).map(function(e){return parseString(e,r)}).filter(Boolean);var n=createNullObj();return e.filter(isNonEmptyString).reduce(function(e,t){var a=parseString(t,r);return a&&!isForbiddenKey(a.name)&&(e[a.name]=a),e},n)}function splitCookiesString(e){if(Array.isArray(e))return e;if("string"!=typeof e)return[];var t,r,a,n,i,s=[],o=0;function skipWhitespace(){for(;o<e.length&&/\s/.test(e.charAt(o));)o+=1;return o<e.length}function notSpecialChar(){return"="!==(r=e.charAt(o))&&";"!==r&&","!==r}for(;o<e.length;){for(t=o,i=!1;skipWhitespace();)if(","===(r=e.charAt(o))){for(a=o,o+=1,skipWhitespace(),n=o;o<e.length&&notSpecialChar();)o+=1;o<e.length&&"="===e.charAt(o)?(i=!0,o=n,s.push(e.substring(t,a)),t=o):o=a+1}else o+=1;(!i||o>=e.length)&&s.push(e.substring(t,e.length))}return s}e.exports=parse,e.exports.parse=parse,e.exports.parseString=parseString,e.exports.splitCookiesString=splitCookiesString},5669:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},a=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(r=e.isMaybeSingle)&&void 0!==r&&r,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var a=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let n=this.fetch,i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,n,i,s;let o=null,c=null,l=null,d=e.status,u=e.statusText;if(e.ok){if("HEAD"!==a.method){let t=await e.text();""===t||(c="text/csv"===a.headers.get("Accept")?t:a.headers.get("Accept")&&(null===(i=a.headers.get("Accept"))||void 0===i?void 0:i.includes("application/vnd.pgrst.plan+text"))?t:JSON.parse(t))}let r=null===(t=a.headers.get("Prefer"))||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),s=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");r&&s&&s.length>1&&(l=parseInt(s[1])),a.isMaybeSingle&&"GET"===a.method&&Array.isArray(c)&&(c.length>1?(o={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,l=null,d=406,u="Not Acceptable"):c=1===c.length?c[0]:null)}else{let t=await e.text();try{o=JSON.parse(t),Array.isArray(o)&&404===e.status&&(c=[],o=null,d=200,u="OK")}catch(r){404===e.status&&""===t?(d=204,u="No Content"):o={message:t}}if(o&&a.isMaybeSingle&&(null==o||null===(s=o.details)||void 0===s?void 0:s.includes("0 rows"))&&(o=null,d=200,u="OK"),o&&a.shouldThrowOnError)throw new r(o)}return{error:o,data:c,count:l,status:d,statusText:u}});return this.shouldThrowOnError||(i=i.catch(e=>{var t,r,a,n,i,s;let o="",c=null==e?void 0:e.cause;if(c){let t=null!==(r=null==c?void 0:c.message)&&void 0!==r?r:"",s=null!==(a=null==c?void 0:c.code)&&void 0!==a?a:"";o=`${null!==(n=null==e?void 0:e.name)&&void 0!==n?n:"FetchError"}: ${null==e?void 0:e.message}

Caused by: ${null!==(i=null==c?void 0:c.name)&&void 0!==i?i:"Error"}: ${t}`,s&&(o+=` (${s})`),(null==c?void 0:c.stack)&&(o+=`
${c.stack}`)}else o=null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:"";return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},n=class extends a{select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:a,referencedTable:n=a}={}){let i=n?`${n}.order`:"order",s=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${s?`${s},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let a=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:a=r}={}){let n=void 0===a?"offset":`${a}.offset`,i=void 0===a?"limit":`${a}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:a=!1,wal:n=!1,format:i="text"}={}){var s;let o=[e?"analyze":null,t?"verbose":null,r?"settings":null,a?"buffers":null,n?"wal":null].filter(Boolean).join("|"),c=null!==(s=this.headers.get("Accept"))&&void 0!==s?s:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${o};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};let i=RegExp("[,()]");var s=class extends n{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&i.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&i.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:a}={}){let n="";"plain"===a?n="pl":"phrase"===a?n="ph":"websearch"===a&&(n="w");let i=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${n}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let a=r?`${r}.or`:"or";return this.url.searchParams.append(a,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},o=class{constructor(e,{headers:t={},schema:r,fetch:a}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=a}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){let{head:r=!1,count:a}=null!=t?t:{},n=!1,i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join(""),{url:o,headers:c}=this.cloneRequestState();return o.searchParams.set("select",i),a&&c.append("Prefer",`count=${a}`),new s({method:r?"HEAD":"GET",url:o,headers:c,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var a;let{url:n,headers:i}=this.cloneRequestState();if(t&&i.append("Prefer",`count=${t}`),r||i.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);n.searchParams.set("columns",e.join(","))}}return new s({method:"POST",url:n,headers:i,schema:this.schema,body:e,fetch:null!==(a=this.fetch)&&void 0!==a?a:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:a,defaultToNull:n=!0}={}){var i;let{url:o,headers:c}=this.cloneRequestState();if(c.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),void 0!==t&&o.searchParams.set("on_conflict",t),a&&c.append("Prefer",`count=${a}`),n||c.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);o.searchParams.set("columns",e.join(","))}}return new s({method:"POST",url:o,headers:c,schema:this.schema,body:e,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}update(e,{count:t}={}){var r;let{url:a,headers:n}=this.cloneRequestState();return t&&n.append("Prefer",`count=${t}`),new s({method:"PATCH",url:a,headers:n,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})}delete({count:e}={}){var t;let{url:r,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new s({method:"DELETE",url:r,headers:a,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})}},c=class PostgrestClient{constructor(e,{headers:t={},schema:r,fetch:a}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=a}from(e){if(!e||"string"!=typeof e||""===e.trim())throw Error("Invalid relation name: relation must be a non-empty string.");return new o(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new PostgrestClient(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:a=!1,count:n}={}){var i;let o,c;let l=new URL(`${this.url}/rpc/${e}`),_isObject=e=>null!==e&&"object"==typeof e&&(!Array.isArray(e)||e.some(_isObject)),d=r&&Object.values(t).some(_isObject);d?(o="POST",c=t):r||a?(o=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{l.searchParams.append(e,t)})):(o="POST",c=t);let u=new Headers(this.headers);return d?u.set("Prefer",n?`count=${n},return=minimal`:"return=minimal"):n&&u.set("Prefer",`count=${n}`),new s({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:null!==(i=this.fetch)&&void 0!==i?i:fetch})}};t.PostgrestBuilder=a,t.PostgrestClient=c,t.PostgrestError=r,t.PostgrestFilterBuilder=s,t.PostgrestQueryBuilder=o,t.PostgrestTransformBuilder=n,t.default={PostgrestClient:c,PostgrestQueryBuilder:o,PostgrestFilterBuilder:s,PostgrestTransformBuilder:n,PostgrestBuilder:a,PostgrestError:r}},1307:(e,t,r)=>{let a,n=r(5410);var i=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function isStorageError(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}var s=class extends i{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},o=class extends i{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};let resolveFetch$1=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),resolveResponse$1=()=>Response,recursiveToCamel=e=>{if(Array.isArray(e))return e.map(e=>recursiveToCamel(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(([e,r])=>{let a=e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[a]=recursiveToCamel(r)}),t},isPlainObject$1=e=>{if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},isValidBucketName=e=>!(!e||"string"!=typeof e||0===e.length||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\"))&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=_typeof(a))return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function toPropertyKey(e){var t=toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _defineProperty(e,t,r){return(t=toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let _getErrorMessage$1=e=>{var t;return e.msg||e.message||e.error_description||("string"==typeof e.error?e.error:null===(t=e.error)||void 0===t?void 0:t.message)||JSON.stringify(e)},handleError$1=async(e,t,r)=>{e instanceof await resolveResponse$1()&&!(null==r?void 0:r.noResolveJson)?e.json().then(r=>{let a=e.status||500,n=(null==r?void 0:r.statusCode)||a+"";t(new s(_getErrorMessage$1(r),a,n))}).catch(e=>{t(new o(_getErrorMessage$1(e),e))}):t(new o(_getErrorMessage$1(e),e))},_getRequestParams$1=(e,t,r,a)=>{let n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&a?(isPlainObject$1(a)?(n.headers=_objectSpread2({"Content-Type":"application/json"},null==t?void 0:t.headers),n.body=JSON.stringify(a)):n.body=a,(null==t?void 0:t.duplex)&&(n.duplex=t.duplex),_objectSpread2(_objectSpread2({},n),r)):n};async function _handleRequest$1(e,t,r,a,n,i){return new Promise((s,o)=>{e(r,_getRequestParams$1(t,a,n,i)).then(e=>{if(!e.ok)throw e;return(null==a?void 0:a.noResolveJson)?e:e.json()}).then(e=>s(e)).catch(e=>handleError$1(e,o,a))})}async function get(e,t,r,a){return _handleRequest$1(e,"GET",t,r,a)}async function post$1(e,t,r,a,n){return _handleRequest$1(e,"POST",t,a,n,r)}async function put(e,t,r,a,n){return _handleRequest$1(e,"PUT",t,a,n,r)}async function head(e,t,r,a){return _handleRequest$1(e,"HEAD",t,_objectSpread2(_objectSpread2({},r),{},{noResolveJson:!0}),a)}async function remove(e,t,r,a,n){return _handleRequest$1(e,"DELETE",t,a,n,r)}var c=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}};a=Symbol.toStringTag;var l=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[a]="BlobDownloadBuilder",this.promise=null}asStream(){return new c(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await (await this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}};let d={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},u={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var h=class{constructor(e,t={},r,a){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=resolveFetch$1(a)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,a){try{let n;let i=_objectSpread2(_objectSpread2({},u),a),s=_objectSpread2(_objectSpread2({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)}),o=i.metadata;"undefined"!=typeof Blob&&r instanceof Blob?((n=new FormData).append("cacheControl",i.cacheControl),o&&n.append("metadata",this.encodeMetadata(o)),n.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?((n=r).has("cacheControl")||n.append("cacheControl",i.cacheControl),o&&!n.has("metadata")&&n.append("metadata",this.encodeMetadata(o))):(n=r,s["cache-control"]=`max-age=${i.cacheControl}`,s["content-type"]=i.contentType,o&&(s["x-metadata"]=this.toBase64(this.encodeMetadata(o))),("undefined"!=typeof ReadableStream&&n instanceof ReadableStream||n&&"object"==typeof n&&"pipe"in n&&"function"==typeof n.pipe)&&!i.duplex&&(i.duplex="half")),(null==a?void 0:a.headers)&&(s=_objectSpread2(_objectSpread2({},s),a.headers));let c=this._removeEmptyFolders(t),l=this._getFinalPath(c),d=await ("PUT"==e?put:post$1)(this.fetch,`${this.url}/object/${l}`,n,_objectSpread2({headers:s},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{}));return{data:{path:c,id:d.Id,fullPath:d.Key},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,a){let n=this._removeEmptyFolders(e),i=this._getFinalPath(n),s=new URL(this.url+`/object/upload/sign/${i}`);s.searchParams.set("token",t);try{let e;let t=_objectSpread2({upsert:u.upsert},a),i=_objectSpread2(_objectSpread2({},this.headers),{"x-upsert":String(t.upsert)});return"undefined"!=typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType),{data:{path:n,fullPath:(await put(this.fetch,s.toString(),e,{headers:i})).Key},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async createSignedUploadUrl(e,t){try{let r=this._getFinalPath(e),a=_objectSpread2({},this.headers);(null==t?void 0:t.upsert)&&(a["x-upsert"]="true");let n=await post$1(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),s=new URL(this.url+n.url),o=s.searchParams.get("token");if(!o)throw new i("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:o},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){try{return{data:await post$1(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async copy(e,t,r){try{return{data:{path:(await post$1(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async createSignedUrl(e,t,r){try{let a=this._getFinalPath(e),n=await post$1(this.fetch,`${this.url}/object/sign/${a}`,_objectSpread2({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n={signedUrl:encodeURI(`${this.url}${n.signedURL}${i}`)},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async createSignedUrls(e,t,r){var a=this;try{let n=await post$1(a.fetch,`${a.url}/object/sign/${a.bucketId}`,{expiresIn:t,paths:e},{headers:a.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n.map(e=>_objectSpread2(_objectSpread2({},e),{},{signedUrl:e.signedURL?encodeURI(`${a.url}${e.signedURL}${i}`):null})),error:null}}catch(e){if(a.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}download(e,t){let r=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",a=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),n=a?`?${a}`:"",i=this._getFinalPath(e);return new l(()=>get(this.fetch,`${this.url}/${r}/${i}${n}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}async info(e){let t=this._getFinalPath(e);try{return{data:recursiveToCamel(await get(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers})),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async exists(e){let t=this._getFinalPath(e);try{return await head(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e)&&e instanceof o){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}}getPublicUrl(e,t){let r=this._getFinalPath(e),a=[],n=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==n&&a.push(n);let i=void 0!==(null==t?void 0:t.transform)?"render/image":"object",s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==s&&a.push(s);let o=a.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${o}`)}}}async remove(e){try{return{data:await remove(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async list(e,t,r){try{let a=_objectSpread2(_objectSpread2(_objectSpread2({},d),t),{},{prefix:e||""});return{data:await post$1(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async listV2(e,t){try{let r=_objectSpread2({},e);return{data:await post$1(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};let p="2.90.1",f={"X-Client-Info":`storage-js/${p}`};var y=class{constructor(e,t={},r,a){this.shouldThrowOnError=!1;let n=new URL(e);(null==a?void 0:a.useNewHostname)&&/supabase\.(co|in|red)$/.test(n.hostname)&&!n.hostname.includes("storage.supabase.")&&(n.hostname=n.hostname.replace("supabase.","storage.supabase.")),this.url=n.href.replace(/\/$/,""),this.headers=_objectSpread2(_objectSpread2({},f),t),this.fetch=resolveFetch$1(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){try{let t=this.listBucketOptionsToQueryString(e);return{data:await get(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async getBucket(e){try{return{data:await get(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async createBucket(e,t={public:!1}){try{return{data:await post$1(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async updateBucket(e,t){try{return{data:await put(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async emptyBucket(e){try{return{data:await post$1(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async deleteBucket(e){try{return{data:await remove(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}listBucketOptionsToQueryString(e){let t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},m=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=_objectSpread2(_objectSpread2({},f),t),this.fetch=resolveFetch$1(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){try{return{data:await post$1(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async listBuckets(e){try{let t=new URLSearchParams;(null==e?void 0:e.limit)!==void 0&&t.set("limit",e.limit.toString()),(null==e?void 0:e.offset)!==void 0&&t.set("offset",e.offset.toString()),(null==e?void 0:e.sortColumn)&&t.set("sortColumn",e.sortColumn),(null==e?void 0:e.sortOrder)&&t.set("sortOrder",e.sortOrder),(null==e?void 0:e.search)&&t.set("search",e.search);let r=t.toString(),a=r?`${this.url}/bucket?${r}`:`${this.url}/bucket`;return{data:await get(this.fetch,a,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}async deleteBucket(e){try{return{data:await remove(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}}from(e){var t=this;if(!isValidBucketName(e))throw new i("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");let r=new n.IcebergRestCatalog({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),a=this.shouldThrowOnError;return new Proxy(r,{get(e,t){let r=e[t];return"function"!=typeof r?r:async(...t)=>{try{return{data:await r.apply(e,t),error:null}}catch(e){if(a)throw e;return{data:null,error:e}}}}})}};let g={"X-Client-Info":`storage-js/${p}`,"Content-Type":"application/json"};var w=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function isStorageVectorsError(e){return"object"==typeof e&&null!==e&&"__isStorageVectorsError"in e}var b=class extends w{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},S=class extends w{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};let v=function(e){return e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded",e}({}),resolveFetch=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),isPlainObject=e=>{if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},_getErrorMessage=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),handleError=async(e,t,r)=>{if(e&&"object"==typeof e&&"status"in e&&"ok"in e&&"number"==typeof e.status&&!(null==r?void 0:r.noResolveJson)){let r=e.status||500;if("function"==typeof e.json)e.json().then(e=>{let a=(null==e?void 0:e.statusCode)||(null==e?void 0:e.code)||r+"";t(new b(_getErrorMessage(e),r,a))}).catch(()=>{let a=r+"";t(new b(e.statusText||`HTTP ${r} error`,r,a))});else{let a=r+"";t(new b(e.statusText||`HTTP ${r} error`,r,a))}}else t(new S(_getErrorMessage(e),e))},_getRequestParams=(e,t,r,a)=>{let n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&a?(isPlainObject(a)?(n.headers=_objectSpread2({"Content-Type":"application/json"},null==t?void 0:t.headers),n.body=JSON.stringify(a)):n.body=a,_objectSpread2(_objectSpread2({},n),r)):n};async function _handleRequest(e,t,r,a,n,i){return new Promise((s,o)=>{e(r,_getRequestParams(t,a,n,i)).then(e=>{if(!e.ok)throw e;if(null==a?void 0:a.noResolveJson)return e;let t=e.headers.get("content-type");return t&&t.includes("application/json")?e.json():{}}).then(e=>s(e)).catch(e=>handleError(e,o,a))})}async function post(e,t,r,a,n){return _handleRequest(e,"POST",t,a,n,r)}var E=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=_objectSpread2(_objectSpread2({},g),t),this.fetch=resolveFetch(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){try{return{data:await post(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers})||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageVectorsError(e))return{data:null,error:e};throw e}}async getIndex(e,t){try{return{data:await post(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageVectorsError(e))return{data:null,error:e};throw e}}async listIndexes(e){try{return{data:await post(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageVectorsError(e))return{data:null,error:e};throw e}}async deleteIndex(e,t){try{return{data:await post(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers})||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageVectorsError(e))return{data:null,error:e};throw e}}},_=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=_objectSpread2(_objectSpread2({},g),t),this.fetch=resolveFetch(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){try{if(e.vectors.length<1||e.vectors.length>500)throw Error("Vector batch size must be between 1 and 500 items");return{data:await post(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers})||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageVectorsError(e))return{data:null,error:e};throw e}}async getVectors(e){try{return{data:await post(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageVectorsError(e))return{data:null,error:e};throw e}}async listVectors(e){try{if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await post(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageVectorsError(e))return{data:null,error:e};throw e}}async queryVectors(e){try{return{data:await post(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageVectorsError(e))return{data:null,error:e};throw e}}async deleteVectors(e){try{if(e.keys.length<1||e.keys.length>500)throw Error("Keys batch size must be between 1 and 500 items");return{data:await post(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers})||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageVectorsError(e))return{data:null,error:e};throw e}}},P=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=_objectSpread2(_objectSpread2({},g),t),this.fetch=resolveFetch(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){try{return{data:await post(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers})||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageVectorsError(e))return{data:null,error:e};throw e}}async getBucket(e){try{return{data:await post(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageVectorsError(e))return{data:null,error:e};throw e}}async listBuckets(e={}){try{return{data:await post(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageVectorsError(e))return{data:null,error:e};throw e}}async deleteBucket(e){try{return{data:await post(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers})||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageVectorsError(e))return{data:null,error:e};throw e}}},k=class extends P{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new O(this.url,this.headers,e,this.fetch)}async createBucket(e){return super.createBucket.call(this,e)}async getBucket(e){return super.getBucket.call(this,e)}async listBuckets(e={}){return super.listBuckets.call(this,e)}async deleteBucket(e){return super.deleteBucket.call(this,e)}},O=class extends E{constructor(e,t,r,a){super(e,t,a),this.vectorBucketName=r}async createIndex(e){return super.createIndex.call(this,_objectSpread2(_objectSpread2({},e),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(e={}){return super.listIndexes.call(this,_objectSpread2(_objectSpread2({},e),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(e){return super.getIndex.call(this,this.vectorBucketName,e)}async deleteIndex(e){return super.deleteIndex.call(this,this.vectorBucketName,e)}index(e){return new J(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},J=class extends _{constructor(e,t,r,a,n){super(e,t,n),this.vectorBucketName=r,this.indexName=a}async putVectors(e){return super.putVectors.call(this,_objectSpread2(_objectSpread2({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async getVectors(e){return super.getVectors.call(this,_objectSpread2(_objectSpread2({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async listVectors(e={}){return super.listVectors.call(this,_objectSpread2(_objectSpread2({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async queryVectors(e){return super.queryVectors.call(this,_objectSpread2(_objectSpread2({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async deleteVectors(e){return super.deleteVectors.call(this,_objectSpread2(_objectSpread2({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}},C=class extends y{constructor(e,t={},r,a){super(e,t,r,a)}from(e){return new h(this.url,this.headers,e,this.fetch)}get vectors(){return new k(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new m(this.url+"/iceberg",this.headers,this.fetch)}};t.StorageAnalyticsClient=m,t.StorageApiError=s,t.StorageClient=C,t.StorageError=i,t.StorageUnknownError=o,t.StorageVectorsApiError=b,t.StorageVectorsClient=k,t.StorageVectorsError=w,t.StorageVectorsErrorCode=v,t.StorageVectorsUnknownError=S,t.VectorBucketApi=P,t.VectorBucketScope=O,t.VectorDataApi=_,t.VectorIndexApi=E,t.VectorIndexScope=J,t.isPlainObject=isPlainObject,t.isStorageError=isStorageError,t.isStorageVectorsError=isStorageVectorsError,t.normalizeToFloat32=e=>Array.from(new Float32Array(e)),t.resolveFetch=resolveFetch,t.resolveResponse=()=>Response,t.validateVectorDimension=(e,t)=>{if(void 0!==t&&e.float32.length!==t)throw Error(`Vector dimension mismatch: expected ${t}, got ${e.float32.length}`)}},8509:(e,t,r)=>{let a=r(9233),n=r(5669),i=r(4653),s=r(1307),o=r(8027),c="";c="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let l={"X-Client-Info":`supabase-js-${c}/2.90.1`},d={headers:l},u={schema:"public"},h={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},p={};function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,t||"default");if("object"!=_typeof(a))return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function toPropertyKey(e){var t=toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _defineProperty(e,t,r){return(t=toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach(function(t){_defineProperty(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let resolveFetch=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),resolveHeadersConstructor=()=>Headers,fetchWithAuth=(e,t,r)=>{let a=resolveFetch(r),n=resolveHeadersConstructor();return async(r,i)=>{var s;let o=null!==(s=await t())&&void 0!==s?s:e,c=new n(null==i?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${o}`),a(r,_objectSpread2(_objectSpread2({},i),{},{headers:c}))}};function ensureTrailingSlash(e){return e.endsWith("/")?e:e+"/"}function applySettingDefaults(e,t){var r,a;let{db:n,auth:i,realtime:s,global:o}=e,{db:c,auth:l,realtime:d,global:u}=t,h={db:_objectSpread2(_objectSpread2({},c),n),auth:_objectSpread2(_objectSpread2({},l),i),realtime:_objectSpread2(_objectSpread2({},d),s),storage:{},global:_objectSpread2(_objectSpread2(_objectSpread2({},u),o),{},{headers:_objectSpread2(_objectSpread2({},null!==(r=null==u?void 0:u.headers)&&void 0!==r?r:{}),null!==(a=null==o?void 0:o.headers)&&void 0!==a?a:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function validateSupabaseUrl(e){let t=null==e?void 0:e.trim();if(!t)throw Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(ensureTrailingSlash(t))}catch(e){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var f=class extends o.AuthClient{constructor(e){super(e)}},y=class{constructor(e,t,r){var a,i,o;this.supabaseUrl=e,this.supabaseKey=t;let c=validateSupabaseUrl(e);if(!t)throw Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);let l=`sb-${c.hostname.split(".")[0]}-auth-token`,f={db:u,realtime:p,auth:_objectSpread2(_objectSpread2({},h),{},{storageKey:l}),global:d},y=applySettingDefaults(null!=r?r:{},f);this.storageKey=null!==(a=y.auth.storageKey)&&void 0!==a?a:"",this.headers=null!==(i=y.global.headers)&&void 0!==i?i:{},y.accessToken?(this.accessToken=y.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(o=y.auth)&&void 0!==o?o:{},this.headers,y.global.fetch),this.fetch=fetchWithAuth(t,this._getAccessToken.bind(this),y.global.fetch),this.realtime=this._initRealtimeClient(_objectSpread2({headers:this.headers,accessToken:this._getAccessToken.bind(this)},y.realtime)),this.accessToken&&this.accessToken().then(e=>this.realtime.setAuth(e)).catch(e=>console.warn("Failed to set initial Realtime auth token:",e)),this.rest=new n.PostgrestClient(new URL("rest/v1",c).href,{headers:this.headers,schema:y.db.schema,fetch:this.fetch}),this.storage=new s.StorageClient(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),y.accessToken||this._listenForAuthEvents()}get functions(){return new a.FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();let{data:r}=await this.auth.getSession();return null!==(e=null===(t=r.session)||void 0===t?void 0:t.access_token)&&void 0!==e?e:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:n,storageKey:i,flowType:s,lock:o,debug:c,throwOnError:l},d,u){let h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new f({url:this.authUrl.href,headers:_objectSpread2(_objectSpread2({},h),d),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:a,userStorage:n,flowType:s,lock:o,debug:c,throwOnError:l,fetch:u,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new i.RealtimeClient(this.realtimeUrl.href,_objectSpread2(_objectSpread2({},e),{},{params:_objectSpread2(_objectSpread2({},{apikey:this.supabaseKey}),null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}};(function(){if("undefined"!=typeof window)return!1;let e=globalThis.process;if(!e)return!1;let t=e.version;if(null==t)return!1;let r=t.match(/^v(\d+)\./);return!!r&&18>=parseInt(r[1],10)})()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217"),Object.defineProperty(t,"FunctionRegion",{enumerable:!0,get:function(){return a.FunctionRegion}}),Object.defineProperty(t,"FunctionsError",{enumerable:!0,get:function(){return a.FunctionsError}}),Object.defineProperty(t,"FunctionsFetchError",{enumerable:!0,get:function(){return a.FunctionsFetchError}}),Object.defineProperty(t,"FunctionsHttpError",{enumerable:!0,get:function(){return a.FunctionsHttpError}}),Object.defineProperty(t,"FunctionsRelayError",{enumerable:!0,get:function(){return a.FunctionsRelayError}}),Object.defineProperty(t,"PostgrestError",{enumerable:!0,get:function(){return n.PostgrestError}}),t.SupabaseClient=y,t.createClient=(e,t,r)=>new y(e,t,r),Object.keys(o).forEach(function(e){"default"===e||Object.prototype.hasOwnProperty.call(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}),Object.keys(i).forEach(function(e){"default"===e||Object.prototype.hasOwnProperty.call(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}})})},5410:(e,t)=>{"use strict";var r=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown="CommitStateUnknownException"===t.icebergType||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};function buildUrl(e,t,r){let a=new URL(t,e);if(r)for(let[e,t]of Object.entries(r))void 0!==t&&a.searchParams.set(e,t);return a.toString()}async function buildAuthHeaders(e){return e&&"none"!==e.type?"bearer"===e.type?{Authorization:`Bearer ${e.token}`}:"header"===e.type?{[e.name]:e.value}:"custom"===e.type?await e.getHeaders():{}:{}}function createFetchClient(e){let t=e.fetchImpl??globalThis.fetch;return{async request({method:a,path:n,query:i,body:s,headers:o}){let c=buildUrl(e.baseUrl,n,i),l=await buildAuthHeaders(e.auth),d=await t(c,{method:a,headers:{...s?{"Content-Type":"application/json"}:{},...l,...o},body:s?JSON.stringify(s):void 0}),u=await d.text(),h=(d.headers.get("content-type")||"").includes("application/json"),p=h&&u?JSON.parse(u):u;if(!d.ok){let e=h?p:void 0,t=e?.error;throw new r(t?.message??`Request failed with status ${d.status}`,{status:d.status,icebergType:t?.type,icebergCode:t?.code,details:e})}return{status:d.status,headers:d.headers,data:p}}}}function namespaceToPath(e){return e.join("\x1f")}var a=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){let t=e?{parent:namespaceToPath(e.namespace)}:void 0,r=await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t});return r.data.namespaces.map(e=>({namespace:e}))}async createNamespace(e,t){let r={namespace:e.namespace,properties:t?.properties},a=await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r});return a.data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${namespaceToPath(e.namespace)}`})}async loadNamespaceMetadata(e){let t=await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${namespaceToPath(e.namespace)}`});return{properties:t.data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${namespaceToPath(e.namespace)}`}),!0}catch(e){if(e instanceof r&&404===e.status)return!1;throw e}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(e){if(e instanceof r&&409===e.status)return;throw e}}};function namespaceToPath2(e){return e.join("\x1f")}var n=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){let t=await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${namespaceToPath2(e.namespace)}/tables`});return t.data.identifiers}async createTable(e,t){let r={};this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation);let a=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${namespaceToPath2(e.namespace)}/tables`,body:t,headers:r});return a.data.metadata}async updateTable(e,t){let r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${namespaceToPath2(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${namespaceToPath2(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){let t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);let r=await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${namespaceToPath2(e.namespace)}/tables/${e.name}`,headers:t});return r.data.metadata}async tableExists(e){let t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${namespaceToPath2(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(e){if(e instanceof r&&404===e.status)return!1;throw e}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(a){if(a instanceof r&&409===a.status)return await this.loadTable({namespace:e.namespace,name:t.name});throw a}}},i=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);let r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=createFetchClient({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new a(this.client,t),this.tableOps=new n(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},s=/^decimal\s*\(\s*(\d+)\s*,\s*(\d+)\s*\)$/,o=/^fixed\s*\[\s*(\d+)\s*\]$/;function parseDecimalType(e){let t=e.match(s);return t?{precision:parseInt(t[1],10),scale:parseInt(t[2],10)}:null}function parseFixedType(e){let t=e.match(o);return t?{length:parseInt(t[1],10)}:null}function isDecimalType(e){return s.test(e)}function isFixedType(e){return o.test(e)}function typesEqual(e,t){let r=parseDecimalType(e),a=parseDecimalType(t);if(r&&a)return r.precision===a.precision&&r.scale===a.scale;let n=parseFixedType(e),i=parseFixedType(t);return n&&i?n.length===i.length:e===t}function getCurrentSchema(e){return e.schemas.find(t=>t["schema-id"]===e["current-schema-id"])}t.IcebergError=r,t.IcebergRestCatalog=i,t.getCurrentSchema=getCurrentSchema,t.isDecimalType=isDecimalType,t.isFixedType=isFixedType,t.parseDecimalType=parseDecimalType,t.parseFixedType=parseFixedType,t.typesEqual=typesEqual}};