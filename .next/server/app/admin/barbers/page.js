(()=>{var e={};e.id=596,e.ids=[596],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},1350:(e,r,a)=>{"use strict";a.r(r),a.d(r,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var t=a(7096),i=a(6132),s=a(7284),n=a.n(s),o=a(2564),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);a.d(r,l);let d=["",{children:["admin",{children:["barbers",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,296)),"C:\\Users\\DAVID\\OneDrive\\Documentos\\barber-platform\\app\\admin\\barbers\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,5719)),"C:\\Users\\DAVID\\OneDrive\\Documentos\\barber-platform\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,2834)),"C:\\Users\\DAVID\\OneDrive\\Documentos\\barber-platform\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,9291,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\DAVID\\OneDrive\\Documentos\\barber-platform\\app\\admin\\barbers\\page.tsx"],u="/admin/barbers/page",x={require:a,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/admin/barbers/page",pathname:"/admin/barbers",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},8620:(e,r,a)=>{Promise.resolve().then(a.bind(a,3748))},3748:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>AdminBarbersPage});var t=a(784),i=a(9885),s=a(3334),n=a(8699);let o=["Domingo","Lunes","Martes","Mi\xe9rcoles","Jueves","Viernes","S\xe1bado"];function AdminBarbersPage(){let[e,r]=(0,i.useState)([]),[a,l]=(0,i.useState)(!0),[d,c]=(0,i.useState)(""),[u,x]=(0,i.useState)(!1),[m,p]=(0,i.useState)(""),[b,h]=(0,i.useState)(null),[f,v]=(0,i.useState)([]),[g,y]=(0,i.useState)(!1),_=(0,s.createClientComponentClient)(),fetchBarbers=async()=>{l(!0);let{data:e}=await _.from("perfiles").select("*").eq("rol","barbero").order("nombre");e&&r(e),l(!1)},fetchSchedules=async e=>{let{data:r}=await _.from("horarios_disponibilidad").select("*").eq("barbero_id",e),a=Array.from({length:7}).map((e,a)=>{let t=r?.find(e=>e.dia_semana===a);return t?{id:t.id,dia_semana:t.dia_semana,hora_inicio:t.hora_inicio,hora_fin:t.hora_fin,activo:t.activo}:{dia_semana:a,hora_inicio:"09:00",hora_fin:"18:00",activo:!1}});v(a)};(0,i.useEffect)(()=>{fetchBarbers()},[]);let handleEditSchedule=e=>{h(e),fetchSchedules(e.id)},handleSaveSchedule=async()=>{if(!b)return;y(!0);let e=f.map(e=>({barbero_id:b.id,dia_semana:e.dia_semana,hora_inicio:e.hora_inicio,hora_fin:e.hora_fin,activo:e.activo})),{error:r}=await _.from("horarios_disponibilidad").delete().eq("barbero_id",b.id);if(r)alert("Error preparando actualizaci\xf3n: "+r.message);else{let{error:r}=await _.from("horarios_disponibilidad").insert(e);r?alert("Error guardando: "+r.message):alert("\xa1Horarios actualizados exitosamente!")}y(!1)},handlePromote=async e=>{e.preventDefault(),x(!0),p("");let{data:r,error:a}=await _.from("perfiles").select("*").ilike("email",d.trim()).maybeSingle();if(a||!r){p("❌ Usuario no encontrado."),x(!1);return}let{error:t}=await _.from("perfiles").update({rol:"barbero"}).eq("id",r.id);t?p(`❌ Error: ${t.message}`):(p("✅ \xa1Usuario promovido!"),c(""),fetchBarbers()),x(!1)},handleDemote=async e=>{confirm("\xbfQuitar rol de barbero a este usuario?")&&(await _.from("perfiles").update({rol:"cliente"}).eq("id",e),fetchBarbers())};return(0,t.jsxs)("div",{className:"space-y-8",children:[t.jsx("h1",{className:"text-3xl font-bold text-navy-900",children:"Gesti\xf3n de Equipo"}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-1 space-y-6",children:[(0,t.jsxs)("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-zinc-100",children:[t.jsx("h2",{className:"font-bold text-navy-900 mb-4",children:"Agregar Nuevo Barbero"}),(0,t.jsxs)("form",{onSubmit:handlePromote,className:"space-y-3",children:[t.jsx("input",{type:"email",placeholder:"Email del usuario...",className:"w-full rounded-xl px-4 py-3 outline-none focus:ring-2 focus:ring-navy-900/10 text-sm border border-zinc-200",style:{backgroundColor:"#ffffff",color:"#000000"},autoComplete:"off",value:d,onChange:e=>c(e.target.value)}),t.jsx("button",{disabled:u,className:"w-full bg-navy-900 text-white font-bold py-3 rounded-xl text-sm hover:bg-navy-800 transition-colors disabled:opacity-50",children:u?"Buscando...":"Promover Usuario"}),m&&t.jsx("p",{className:"text-xs font-medium text-center",children:m})]})]}),t.jsx("div",{className:"space-y-3",children:e.map(e=>(0,t.jsxs)("div",{onClick:()=>handleEditSchedule(e),className:(0,n.cn)("p-4 rounded-xl border cursor-pointer transition-all flex items-center gap-3 hover:shadow-md",b?.id===e.id?"bg-navy-900 border-navy-900 text-white":"bg-white border-zinc-200 text-navy-900 hover:border-navy-900/30"),children:[t.jsx("div",{className:(0,n.cn)("w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm",b?.id===e.id?"bg-white/20 text-white":"bg-zinc-100 text-zinc-500"),children:e.nombre?.[0]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"font-bold truncate",children:e.nombre}),t.jsx("p",{className:(0,n.cn)("text-xs truncate",b?.id===e.id?"text-white/60":"text-zinc-400"),children:e.email})]}),t.jsx("span",{className:(0,n.cn)("text-xl",b?.id===e.id?"opacity-100":"opacity-0 group-hover:opacity-100"),children:"\uD83D\uDC49"})]},e.id))})]}),t.jsx("div",{className:"lg:col-span-2",children:b?(0,t.jsxs)("div",{className:"bg-white rounded-3xl shadow-xl border border-zinc-100 overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-8 border-b border-zinc-100 flex justify-between items-center bg-zinc-50/50",children:[(0,t.jsxs)("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-navy-900",children:"Configurar Horario"}),(0,t.jsxs)("p",{className:"text-zinc-500",children:["Editando disponibilidad de ",t.jsx("span",{className:"font-bold text-navy-900",children:b.nombre})]})]}),t.jsx("button",{onClick:()=>handleDemote(b.id),className:"text-red-500 text-sm font-medium hover:bg-red-50 px-3 py-1.5 rounded-lg transition-colors",children:"Eliminar rol"})]}),t.jsx("div",{className:"p-8 space-y-4",children:f.map((e,r)=>(0,t.jsxs)("div",{className:(0,n.cn)("flex items-center gap-4 p-4 rounded-xl transition-colors border",e.activo?"bg-white border-zinc-200":"bg-zinc-50 border-transparent opacity-60"),children:[t.jsx("div",{className:"w-32 font-medium text-navy-900",children:o[e.dia_semana]}),(0,t.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",className:"sr-only peer",checked:e.activo,onChange:e=>{let a=[...f];a[r].activo=e.target.checked,v(a)}}),t.jsx("div",{className:"w-11 h-6 bg-zinc-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-navy-900"})]}),e.activo&&(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-1 justify-end animate-in fade-in duration-300",children:[t.jsx("input",{type:"time",value:e.hora_inicio,onChange:e=>{let a=[...f];a[r].hora_inicio=e.target.value,v(a)},className:"bg-zinc-50 border border-zinc-200 rounded-lg px-2 py-1 text-sm outline-none focus:border-navy-900"}),t.jsx("span",{className:"text-zinc-400",children:"-"}),t.jsx("input",{type:"time",value:e.hora_fin,onChange:e=>{let a=[...f];a[r].hora_fin=e.target.value,v(a)},className:"bg-zinc-50 border border-zinc-200 rounded-lg px-2 py-1 text-sm outline-none focus:border-navy-900"})]}),!e.activo&&t.jsx("div",{className:"flex-1 text-right text-xs text-zinc-400 font-medium uppercase tracking-wider",children:"No Laboral"})]},r))}),(0,t.jsxs)("div",{className:"p-6 bg-zinc-50 border-t border-zinc-100 flex justify-end gap-3 sticky bottom-0",children:[t.jsx("button",{onClick:()=>h(null),className:"px-6 py-3 text-zinc-500 font-bold hover:bg-zinc-100 rounded-xl transition-colors",children:"Cancelar"}),t.jsx("button",{onClick:handleSaveSchedule,disabled:g,className:"px-8 py-3 bg-navy-900 text-white font-bold rounded-xl shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all disabled:opacity-50",children:g?"Guardando...":"Guardar Horario"})]})]}):(0,t.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-zinc-400 border-2 border-dashed border-zinc-200 rounded-3xl p-12 bg-zinc-50/50",children:[t.jsx("span",{className:"text-4xl mb-4",children:"\uD83D\uDC48"}),t.jsx("p",{className:"font-medium",children:"Selecciona un barbero para gestionar su horario"})]})})]})]})}},296:(e,r,a)=>{"use strict";a.r(r),a.d(r,{$$typeof:()=>n,__esModule:()=>s,default:()=>l});var t=a(5153);let i=(0,t.createProxy)(String.raw`C:\Users\DAVID\OneDrive\Documentos\barber-platform\app\admin\barbers\page.tsx`),{__esModule:s,$$typeof:n}=i,o=i.default,l=o},1440:(e,r,a)=>{e.exports=a(614)}};var r=require("../../../webpack-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),a=r.X(0,[657,126,614,334,410,9,299],()=>__webpack_exec__(1350));module.exports=a})();